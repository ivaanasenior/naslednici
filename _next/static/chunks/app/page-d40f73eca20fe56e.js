(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{4948:(e,a,t)=>{Promise.resolve().then(t.bind(t,5432))},5432:(e,a,t)=>{"use strict";t.r(a),t.d(a,{default:()=>aE});var r=t(5155),n=t(2115),s=t(2177),i=t(221),o=t(1153),l=t(9708),d=t(2085),c=t(9434);let m=(0,d.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-[hsl(var(--primary-hover))]",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),u=n.forwardRef((e,a)=>{let{className:t,variant:n,size:s,asChild:i=!1,...o}=e,d=i?l.DX:"button";return(0,r.jsx)(d,{className:(0,c.cn)(m({variant:n,size:s,className:t})),ref:a,...o})});u.displayName="Button";let p=n.forwardRef((e,a)=>{let{className:t,type:n,...s}=e;return(0,r.jsx)("input",{type:n,className:(0,c.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",t),ref:a,...s})});p.displayName="Input";var h=t(1992),j=t(9556),x=t(7381),f=t(518);let v=h.bL;h.YJ;let b=h.WT,N=n.forwardRef((e,a)=>{let{className:t,children:n,...s}=e;return(0,r.jsxs)(h.l9,{ref:a,className:(0,c.cn)("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",t),...s,children:[n,(0,r.jsx)(h.In,{asChild:!0,children:(0,r.jsx)(j.A,{className:"h-4 w-4 opacity-50"})})]})});N.displayName=h.l9.displayName;let g=n.forwardRef((e,a)=>{let{className:t,...n}=e;return(0,r.jsx)(h.PP,{ref:a,className:(0,c.cn)("flex cursor-default items-center justify-center py-1",t),...n,children:(0,r.jsx)(x.A,{className:"h-4 w-4"})})});g.displayName=h.PP.displayName;let y=n.forwardRef((e,a)=>{let{className:t,...n}=e;return(0,r.jsx)(h.wn,{ref:a,className:(0,c.cn)("flex cursor-default items-center justify-center py-1",t),...n,children:(0,r.jsx)(j.A,{className:"h-4 w-4"})})});y.displayName=h.wn.displayName;let k=n.forwardRef((e,a)=>{let{className:t,children:n,position:s="popper",...i}=e;return(0,r.jsx)(h.ZL,{children:(0,r.jsxs)(h.UC,{ref:a,className:(0,c.cn)("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2","popper"===s&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",t),position:s,...i,children:[(0,r.jsx)(g,{}),(0,r.jsx)(h.LM,{className:(0,c.cn)("p-1","popper"===s&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:n}),(0,r.jsx)(y,{})]})})});k.displayName=h.UC.displayName,n.forwardRef((e,a)=>{let{className:t,...n}=e;return(0,r.jsx)(h.JU,{ref:a,className:(0,c.cn)("py-1.5 pl-8 pr-2 text-sm font-semibold",t),...n})}).displayName=h.JU.displayName;let A=n.forwardRef((e,a)=>{let{className:t,children:n,...s}=e;return(0,r.jsxs)(h.q7,{ref:a,className:(0,c.cn)("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t),...s,children:[(0,r.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,r.jsx)(h.VF,{children:(0,r.jsx)(f.A,{className:"h-4 w-4"})})}),(0,r.jsx)(h.p4,{children:n})]})});A.displayName=h.q7.displayName,n.forwardRef((e,a)=>{let{className:t,...n}=e;return(0,r.jsx)(h.wv,{ref:a,className:(0,c.cn)("-mx-1 my-1 h-px bg-muted",t),...n})}).displayName=h.wv.displayName;var w=t(968);let R=(0,d.F)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),M=n.forwardRef((e,a)=>{let{className:t,...n}=e;return(0,r.jsx)(w.b,{ref:a,className:(0,c.cn)(R(),t),...n})});M.displayName=w.b.displayName;let P=s.Op,S=n.createContext({}),D=e=>{let{...a}=e;return(0,r.jsx)(S.Provider,{value:{name:a.name},children:(0,r.jsx)(s.xI,{...a})})},I=()=>{let e=n.useContext(S),a=n.useContext(E),{getFieldState:t,formState:r}=(0,s.xW)(),i=t(e.name,r);if(!e)throw Error("useFormField should be used within <FormField>");let{id:o}=a;return{id:o,name:e.name,formItemId:"".concat(o,"-form-item"),formDescriptionId:"".concat(o,"-form-item-description"),formMessageId:"".concat(o,"-form-item-message"),...i}},E=n.createContext({}),F=n.forwardRef((e,a)=>{let{className:t,...s}=e,i=n.useId();return(0,r.jsx)(E.Provider,{value:{id:i},children:(0,r.jsx)("div",{ref:a,className:(0,c.cn)("space-y-2",t),...s})})});F.displayName="FormItem";let _=n.forwardRef((e,a)=>{let{className:t,...n}=e,{error:s,formItemId:i}=I();return(0,r.jsx)(M,{ref:a,className:(0,c.cn)(s&&"text-destructive",t),htmlFor:i,...n})});_.displayName="FormLabel";let T=n.forwardRef((e,a)=>{let{...t}=e,{error:n,formItemId:s,formDescriptionId:i,formMessageId:o}=I();return(0,r.jsx)(l.DX,{ref:a,id:s,"aria-describedby":n?"".concat(i," ").concat(o):"".concat(i),"aria-invalid":!!n,...t})});T.displayName="FormControl";let O=n.forwardRef((e,a)=>{let{className:t,...n}=e,{formDescriptionId:s}=I();return(0,r.jsx)("p",{ref:a,id:s,className:(0,c.cn)("text-sm text-muted-foreground",t),...n})});O.displayName="FormDescription";let C=n.forwardRef((e,a)=>{var t;let{className:n,children:s,...i}=e,{error:o,formMessageId:l}=I(),d=o?String(null!==(t=null==o?void 0:o.message)&&void 0!==t?t:""):s;return d?(0,r.jsx)("p",{ref:a,id:l,className:(0,c.cn)("text-sm font-medium text-destructive",n),...i,children:d}):null});C.displayName="FormMessage";let z=n.forwardRef((e,a)=>{let{className:t,...n}=e;return(0,r.jsx)("div",{ref:a,className:(0,c.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",t),...n})});z.displayName="Card";let G=n.forwardRef((e,a)=>{let{className:t,...n}=e;return(0,r.jsx)("div",{ref:a,className:(0,c.cn)("flex flex-col space-y-1.5 p-6",t),...n})});G.displayName="CardHeader";let H=n.forwardRef((e,a)=>{let{className:t,...n}=e;return(0,r.jsx)("div",{ref:a,className:(0,c.cn)("text-2xl font-semibold leading-none tracking-tight",t),...n})});H.displayName="CardTitle";let L=n.forwardRef((e,a)=>{let{className:t,...n}=e;return(0,r.jsx)("div",{ref:a,className:(0,c.cn)("text-sm text-muted-foreground",t),...n})});L.displayName="CardDescription";let U=n.forwardRef((e,a)=>{let{className:t,...n}=e;return(0,r.jsx)("div",{ref:a,className:(0,c.cn)("p-6 pt-0",t),...n})});U.displayName="CardContent",n.forwardRef((e,a)=>{let{className:t,...n}=e;return(0,r.jsx)("div",{ref:a,className:(0,c.cn)("flex items-center p-6 pt-0",t),...n})}).displayName="CardFooter";var V=t(7655);let q=n.forwardRef((e,a)=>{let{className:t,children:n,...s}=e;return(0,r.jsxs)(V.bL,{ref:a,className:(0,c.cn)("relative overflow-hidden",t),...s,children:[(0,r.jsx)(V.LM,{className:"h-full w-full rounded-[inherit]",children:n}),(0,r.jsx)(B,{}),(0,r.jsx)(V.OK,{})]})});q.displayName=V.bL.displayName;let B=n.forwardRef((e,a)=>{let{className:t,orientation:n="vertical",...s}=e;return(0,r.jsx)(V.VM,{ref:a,orientation:n,className:(0,c.cn)("flex touch-none select-none transition-colors","vertical"===n&&"h-full w-2.5 border-l border-l-transparent p-[1px]","horizontal"===n&&"h-2.5 flex-col border-t border-t-transparent p-[1px]",t),...s,children:(0,r.jsx)(V.lr,{className:"relative flex-1 rounded-full bg-border"})})});B.displayName=V.VM.displayName;var J=t(4884);let W=n.forwardRef((e,a)=>{let{className:t,...n}=e;return(0,r.jsx)(J.bL,{className:(0,c.cn)("peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input",t),...n,ref:a,children:(0,r.jsx)(J.zi,{className:(0,c.cn)("pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0")})})});W.displayName=J.bL.displayName;var Y=t(9613);let Z=Y.Kq,K=Y.bL,X=Y.l9,$=n.forwardRef((e,a)=>{let{className:t,sideOffset:n=4,...s}=e;return(0,r.jsx)(Y.UC,{ref:a,sideOffset:n,className:(0,c.cn)("z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",t),...s})});$.displayName=Y.UC.displayName;var Q=t(8098),ee=t(8510),ea=t(3798),et=t(1474),er=t(1721),en=t(7270),es=t(8376),ei=t(3095),eo=t(4371),el=t(1429),ed=t(4301),ec=t(7223),em=t(286),eu=t(5452),ep=t(5318);let eh=eu.bL;eu.l9;let ej=eu.ZL,ex=eu.bm,ef=n.forwardRef((e,a)=>{let{className:t,...n}=e;return(0,r.jsx)(eu.hJ,{ref:a,className:(0,c.cn)("fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",t),...n})});ef.displayName=eu.hJ.displayName;let ev=n.forwardRef((e,a)=>{let{className:t,children:n,...s}=e;return(0,r.jsxs)(ej,{children:[(0,r.jsx)(ef,{}),(0,r.jsxs)(eu.UC,{ref:a,className:(0,c.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",t),...s,children:[n,(0,r.jsxs)(eu.bm,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[(0,r.jsx)(ep.A,{className:"h-4 w-4"}),(0,r.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})});ev.displayName=eu.UC.displayName;let eb=e=>{let{className:a,...t}=e;return(0,r.jsx)("div",{className:(0,c.cn)("flex flex-col space-y-1.5 text-center sm:text-left",a),...t})};eb.displayName="DialogHeader";let eN=e=>{let{className:a,...t}=e;return(0,r.jsx)("div",{className:(0,c.cn)("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",a),...t})};eN.displayName="DialogFooter";let eg=n.forwardRef((e,a)=>{let{className:t,...n}=e;return(0,r.jsx)(eu.hE,{ref:a,className:(0,c.cn)("text-lg font-semibold leading-none tracking-tight",t),...n})});eg.displayName=eu.hE.displayName;let ey=n.forwardRef((e,a)=>{let{className:t,...n}=e;return(0,r.jsx)(eu.VY,{ref:a,className:(0,c.cn)("text-sm text-muted-foreground",t),...n})});ey.displayName=eu.VY.displayName;let ek=o.Ik({name:o.Yj().min(1,{message:"Ime nasljednika je obavezno."}),relationship:o.eu("CHILD").default("CHILD"),isAlive:o.zM().default(!0),acceptsInheritance:o.zM().default(!0)}).refine(e=>e.isAlive||!e.acceptsInheritance,{message:"Preminuli nasljednik ne može prihvatiti nasljedstvo.",path:["acceptsInheritance"]});function eA(e){let{isOpen:a,onClose:t,onAddDescendant:o,parentName:l}=e,d=(0,s.mN)({resolver:(0,i.u)(ek),defaultValues:{name:"",relationship:"CHILD",isAlive:!0,acceptsInheritance:!0}}),c=d.watch("isAlive");return(0,n.useEffect)(()=>{c||d.setValue("acceptsInheritance",!1)},[c,d]),(0,n.useEffect)(()=>{a||d.reset()},[a,d]),(0,r.jsx)(eh,{open:a,onOpenChange:e=>!e&&t(),children:(0,r.jsxs)(ev,{className:"sm:max-w-[425px]",children:[(0,r.jsxs)(eb,{children:[(0,r.jsxs)(eg,{children:["Dodaj Nasljednika za ",l]}),(0,r.jsxs)(ey,{children:["Unesite podatke o djetetu preminulog nasljednika (",l,"). Oni će naslijediti njegov dio."]})]}),(0,r.jsx)(P,{...d,children:(0,r.jsxs)("form",{onSubmit:d.handleSubmit(function(e){o({name:e.name,relationship:e.relationship,isAlive:e.isAlive,acceptsInheritance:!!e.isAlive&&e.acceptsInheritance}),d.reset()}),className:"space-y-4 py-4",children:[(0,r.jsx)(D,{control:d.control,name:"name",render:e=>{let{field:a}=e;return(0,r.jsxs)(F,{children:[(0,r.jsx)(_,{children:"Ime Nasljednika (Potomka)"}),(0,r.jsx)(T,{children:(0,r.jsx)(p,{placeholder:"Npr. Petar Petrović",...a,"aria-required":"true"})}),(0,r.jsx)(C,{})]})}}),(0,r.jsx)(D,{control:d.control,name:"isAlive",render:e=>{let{field:a}=e;return(0,r.jsxs)(F,{className:"flex flex-row items-center justify-between rounded-lg border p-3 shadow-sm bg-secondary/90",children:[(0,r.jsxs)("div",{className:"space-y-0.5",children:[(0,r.jsx)(_,{children:"Da li je živ?"}),(0,r.jsx)(O,{children:"Status potomka."})]}),(0,r.jsx)(T,{children:(0,r.jsx)(W,{checked:a.value,onCheckedChange:a.onChange,"aria-label":"Da li je potomak živ"})})]})}}),(0,r.jsx)(D,{control:d.control,name:"acceptsInheritance",render:e=>{let{field:a}=e;return(0,r.jsxs)(F,{className:"flex flex-row items-center justify-between rounded-lg border p-3 shadow-sm bg-secondary/90",children:[(0,r.jsxs)("div",{className:"space-y-0.5",children:[(0,r.jsx)(_,{children:"Da li se prihvata nasljedstva?"}),(0,r.jsx)(O,{children:"Da li potomak prihvata dio nasljedstva."})]}),(0,r.jsx)(T,{children:(0,r.jsx)(W,{checked:a.value,onCheckedChange:a.onChange,disabled:!c,"aria-label":"Da li se potomak prihvata nasljedstva"})})]})}}),(0,r.jsxs)(eN,{children:[(0,r.jsx)(ex,{asChild:!0,children:(0,r.jsx)(u,{type:"button",variant:"ghost",children:"Odustani"})}),(0,r.jsx)(u,{type:"submit",children:"Sačuvaj Potomka"})]})]})})]})})}let ew=e=>{let a=[];return e.forEach(e=>{a.push(e),e.descendants&&(a=a.concat(ew(e.descendants)))}),a},eR=(e,a)=>e.filter(e=>e.id!==a).map(e=>e.descendants&&e.descendants.length>0?{...e,descendants:eR(e.descendants,a)}:e),eM=(e,a,t)=>e.map(e=>{if(e.id===a){let a={...t,acceptsInheritance:!!t.isAlive&&t.acceptsInheritance,descendants:t.descendants||[]};return{...e,descendants:[...e.descendants||[],a]}}return e.descendants&&e.descendants.length>0?{...e,descendants:eM(e.descendants,a,t)}:e}),eP=o.Ik({name:o.Yj().min(1,{message:"Ime nasljednika je obavezno."}),relationship:o.k5(["SPOUSE","CHILD","PARENT","PATERNAL_GRANDFATHER","PATERNAL_GRANDMOTHER","MATERNAL_GRANDFATHER","MATERNAL_GRANDMOTHER","PGF_F","PGF_M","PGM_F","PGM_M","MGF_F","MGF_M","MGM_F","MGM_M"],{required_error:"Odnos prema ostaviocu je obavezan."}),isAlive:o.zM().default(!0),acceptsInheritance:o.zM().default(!0),requestSeparateHalf:o.zM().optional().default(!1)}).refine(e=>e.isAlive||!e.acceptsInheritance,{message:"Preminuli nasljednik ne može prihvatiti nasljedstvo.",path:["acceptsInheritance"]}).refine(e=>"SPOUSE"!==e.relationship||!e.requestSeparateHalf||e.isAlive&&e.acceptsInheritance,{message:"Supružnik može tražiti izdvajanje polovine samo ako je živ i prihvata nasljedstvo.",path:["requestSeparateHalf"]}),eS={SPOUSE:"Supružnik",CHILD:"Dijete",PARENT:"Roditelj",PATERNAL_GRANDFATHER:"Djed (očeva strana)",PATERNAL_GRANDMOTHER:"Baba (očeva strana)",MATERNAL_GRANDFATHER:"Djed (majcina strana)",MATERNAL_GRANDMOTHER:"Baba (majcina strana)",PGF_F:"Pradjed (otac očevog oca)",PGF_M:"Prababa (majka očevog oca)",PGM_F:"Pradjed (otac očeve majke)",PGM_M:"Prababa (majka očeve majke)",MGF_F:"Pradjed (otac majčinog oca)",MGF_M:"Prababa (majka majčinog oca)",MGM_F:"Pradjed (otac majčine majke)",MGM_M:"Prababa (majka majčine majke)"},eD={SPOUSE:Q.A,CHILD:ee.A,PARENT:ea.A,PATERNAL_GRANDFATHER:et.A,PATERNAL_GRANDMOTHER:et.A,MATERNAL_GRANDFATHER:et.A,MATERNAL_GRANDMOTHER:et.A,PGF_F:et.A,PGF_M:et.A,PGM_F:et.A,PGM_M:et.A,MGF_F:et.A,MGF_M:et.A,MGM_F:et.A,MGM_M:et.A},eI=e=>{let{relationship:a}=e,t=eD[a]||er.A;return(0,r.jsx)(t,{className:"mr-2 h-4 w-4 text-muted-foreground"})},eE=e=>{let{isAlive:a,acceptsInheritance:t,requestSeparateHalf:n}=e,s=[];return a?t?(s.push((0,r.jsx)(Z,{children:(0,r.jsxs)(K,{children:[(0,r.jsx)(X,{asChild:!0,children:(0,r.jsx)(es.A,{className:"ml-2 h-4 w-4 text-green-600 cursor-help"})}),(0,r.jsx)($,{children:(0,r.jsx)("p",{children:"Prihvata nasljedstvo"})})]})},"accepts")),n&&s.push((0,r.jsx)(Z,{children:(0,r.jsxs)(K,{children:[(0,r.jsx)(X,{asChild:!0,children:(0,r.jsx)(ei.A,{className:"ml-1 h-4 w-4 text-blue-600 cursor-help"})}),(0,r.jsx)($,{children:(0,r.jsx)("p",{children:"Traži izdvajanje polovine"})})]})},"separateHalf"))):s.push((0,r.jsx)(Z,{children:(0,r.jsxs)(K,{children:[(0,r.jsx)(X,{asChild:!0,children:(0,r.jsx)(eo.A,{className:"ml-2 h-4 w-4 text-destructive cursor-help"})}),(0,r.jsx)($,{children:(0,r.jsx)("p",{children:"Ne prihvata nasljedstvo"})})]})},"rejects")):s.push((0,r.jsx)(Z,{children:(0,r.jsxs)(K,{children:[(0,r.jsx)(X,{asChild:!0,children:(0,r.jsx)(en.A,{className:"ml-2 h-4 w-4 text-muted-foreground cursor-help"})}),(0,r.jsx)($,{children:(0,r.jsx)("p",{children:"Preminuo/la"})})]})},"deceased")),(0,r.jsx)(r.Fragment,{children:s})};function eF(e){let{onAddHeir:a,heirs:t,onRemoveHeir:o,deceasedName:l,setDeceasedName:d,setHeirs:c}=e,[m,h]=(0,n.useState)(!1),[j,x]=(0,n.useState)(!1),[f,g]=(0,n.useState)(null),y=(0,s.mN)({resolver:(0,i.u)(eP),defaultValues:{name:"",relationship:void 0,isAlive:!0,acceptsInheritance:!0,requestSeparateHalf:!1}}),w=y.watch("isAlive"),R=y.watch("relationship"),M=y.watch("acceptsInheritance");(0,n.useEffect)(()=>{w||(y.setValue("acceptsInheritance",!1),y.setValue("requestSeparateHalf",!1)),"SPOUSE"!==R&&y.setValue("requestSeparateHalf",!1),"SPOUSE"!==R||M||y.setValue("requestSeparateHalf",!1)},[w,R,M,y]);let S=e=>{o(e)},I=e=>{g(e),x(!0)},E=()=>{g(null),x(!1)},V=e=>"CHILD"===e||"PARENT"===e||"PATERNAL_GRANDFATHER"===e||"PATERNAL_GRANDMOTHER"===e||"MATERNAL_GRANDFATHER"===e||"MATERNAL_GRANDMOTHER"===e||"PGF_F"===e||"PGF_M"===e||"PGM_F"===e||"PGM_M"===e||"MGF_F"===e||"MGF_M"===e||"MGM_F"===e||"MGM_M"===e,B=(e,a)=>{for(let r of a){var t;if(null===(t=r.descendants)||void 0===t?void 0:t.some(a=>a.id===e))return r;if(r.descendants){let a=B(e,r.descendants);if(a)return a}}return null},J=(0,n.useCallback)(e=>{let{heir:a,level:n=0}=e,s=eS[a.relationship];if(n>0&&"CHILD"===a.relationship){let e=B(a.id,t);s=e?"PARENT"===e.relationship?"Brat/Sestra (potomak od ".concat(e.name,")"):"CHILD"===e.relationship?"Unuk/Unuka (potomak od ".concat(e.name,")"):e.relationship.includes("GRANDFATHER")||e.relationship.includes("GRANDMOTHER")?"Ujak/Stric/Tetka (potomak od ".concat(e.name,")"):e.relationship.startsWith("PGF_")||e.relationship.startsWith("PGM_")||e.relationship.startsWith("MGF_")||e.relationship.startsWith("MGM_")?"Potomak pradjeda/babe (od ".concat(e.name,")"):"Potomak (od ".concat(e.name||"pretka",")"):"Potomak"}return(0,r.jsxs)("li",{className:"flex flex-col p-2 rounded-md border ".concat(n>0?"ml-6 mt-1 bg-secondary/60 border-secondary":"bg-card border-border"),children:[(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"flex items-center flex-wrap gap-x-1",children:[n>0&&(0,r.jsx)(el.A,{className:"mr-1 h-3 w-3 text-muted-foreground flex-shrink-0"}),(0,r.jsx)(eI,{relationship:a.relationship}),(0,r.jsx)("span",{className:"font-medium",children:a.name}),(0,r.jsxs)("span",{className:"text-sm text-muted-foreground",children:["(",s,")"]}),(0,r.jsx)(eE,{isAlive:a.isAlive,acceptsInheritance:a.acceptsInheritance,requestSeparateHalf:a.requestSeparateHalf})]}),(0,r.jsxs)("div",{className:"flex items-center space-x-1 flex-shrink-0",children:[!a.isAlive&&V(a.relationship)&&(0,r.jsx)(Z,{children:(0,r.jsxs)(K,{children:[(0,r.jsx)(X,{asChild:!0,children:(0,r.jsx)(u,{variant:"ghost",size:"icon",onClick:()=>I(a),"aria-label":"Dodaj nasljednika za ".concat(a.name),children:(0,r.jsx)(ed.A,{className:"h-4 w-4 text-primary hover:text-primary/80"})})}),(0,r.jsx)($,{children:(0,r.jsxs)("p",{children:["Dodaj potomka za ",a.name]})})]})}),(0,r.jsx)(u,{variant:"ghost",size:"icon",onClick:()=>S(a.id),"aria-label":"Ukloni ".concat(a.name),children:(0,r.jsx)(ec.A,{className:"h-4 w-4 text-destructive hover:text-destructive/80"})})]})]}),a.descendants&&a.descendants.length>0&&(0,r.jsx)("ul",{className:"mt-2 space-y-1 border-t border-dashed border-muted pt-2",children:a.descendants.map(e=>(0,r.jsx)(J,{heir:e,level:n+1},e.id))})]},a.id)},[S,I,t]);return(0,r.jsxs)("div",{className:"space-y-6 print:hidden",children:[(0,r.jsxs)(z,{className:"border-primary/30 shadow",children:[(0,r.jsx)(G,{className:"bg-primary/5 rounded-t-md",children:(0,r.jsxs)(H,{className:"text-lg flex items-center",children:[(0,r.jsx)(er.A,{className:"mr-2 h-5 w-5 text-primary"})," Podaci o Ostaviocu"]})}),(0,r.jsxs)(U,{className:"pt-4",children:[(0,r.jsx)(p,{placeholder:"Ime i prezime ostavioca",value:l,onChange:e=>d(e.target.value),className:"mb-2","aria-label":"Ime i prezime ostavioca"}),(0,r.jsx)("p",{className:"text-sm text-muted-foreground",children:"Unesite ime osobe čije se nasljedstvo dijeli."})]})]}),(0,r.jsxs)(z,{className:"border-primary/30 shadow",children:[(0,r.jsxs)(G,{className:"bg-primary/5 rounded-t-md",children:[(0,r.jsxs)(H,{className:"text-lg flex items-center",children:[(0,r.jsx)(em.A,{className:"mr-2 h-5 w-5 text-primary"})," Nasljednici"]}),(0,r.jsx)(L,{children:"Dodajte sve potencijalne zakonske nasljednike. Za preminule nasljednike koji mogu imati potomke po pravu predstavljanja (djecu, roditelje, djedove/babe, pradjedove/prababe), dodajte njihove potomke klikom na ikonu plus. Program provjerava nasljedne redove: 1. Djeca/Supružnik; 2. Roditelji/Supružnik (i potomci roditelja - braća/sestre ostavioca); 3. Djedovi/Babe/Supružnik (i njihovi potomci - ujaci/stricevi/tetke ostavioca); 4. Pradjedovi/Prababe (i njihovi potomci)."})]}),(0,r.jsxs)(U,{className:"pt-4",children:[t.length>0&&(0,r.jsx)(q,{className:"h-48 mb-4 border rounded-md p-2 bg-secondary/20",children:(0,r.jsx)("ul",{className:"space-y-2",children:t.map(e=>(0,r.jsx)(J,{heir:e},e.id))})}),!m&&(0,r.jsxs)(u,{onClick:()=>h(!0),variant:"outline",className:"w-full border-primary/50 text-primary hover:bg-primary/10 hover:text-primary",children:[(0,r.jsx)(ed.A,{className:"mr-2 h-4 w-4"})," Dodaj Nasljednika"]}),m&&(0,r.jsx)(P,{...y,children:(0,r.jsxs)("form",{onSubmit:y.handleSubmit(function(e){a({...e,acceptsInheritance:!!e.isAlive&&e.acceptsInheritance,requestSeparateHalf:"SPOUSE"===e.relationship&&!!e.isAlive&&!!e.acceptsInheritance&&e.requestSeparateHalf,id:Date.now().toString(),descendants:[]}),y.reset(),h(!1)}),className:"space-y-4 p-4 border border-dashed border-primary/50 rounded-md bg-secondary/50 mt-4",children:[(0,r.jsx)(D,{control:y.control,name:"name",render:e=>{let{field:a}=e;return(0,r.jsxs)(F,{children:[(0,r.jsx)(_,{children:"Ime Nasljednika"}),(0,r.jsx)(T,{children:(0,r.jsx)(p,{placeholder:"Npr. Marko Marković",...a,"aria-required":"true"})}),(0,r.jsx)(C,{})]})}}),(0,r.jsx)(D,{control:y.control,name:"relationship",render:e=>{let{field:a}=e;return(0,r.jsxs)(F,{children:[(0,r.jsx)("div",{className:"flex items-center justify-between",children:(0,r.jsx)(_,{children:"Odnos prema Ostaviocu"})}),(0,r.jsxs)(v,{onValueChange:a.onChange,value:a.value||"",children:[(0,r.jsx)(T,{children:(0,r.jsx)(N,{"aria-required":"true",children:(0,r.jsx)(b,{placeholder:"Izaberite odnos"})})}),(0,r.jsx)(k,{children:Object.entries(eS).map(e=>{let[a,t]=e;return(0,r.jsx)(A,{value:a,children:t},a)})})]}),(0,r.jsx)(C,{})]})}}),(0,r.jsx)(D,{control:y.control,name:"isAlive",render:e=>{let{field:a}=e;return(0,r.jsxs)(F,{className:"flex flex-row items-center justify-between rounded-lg border p-3 shadow-sm bg-background",children:[(0,r.jsxs)("div",{className:"space-y-0.5",children:[(0,r.jsx)(_,{children:"Da li je nasljednik živ?"}),(0,r.jsx)(O,{children:"Ako nije živ, za određene srodnike moći ćete dodati njihove potomke nakon što sačuvate ovog nasljednika."})]}),(0,r.jsx)(T,{children:(0,r.jsx)(W,{checked:a.value,onCheckedChange:a.onChange,"aria-label":"Da li je nasljednik živ"})})]})}}),(0,r.jsx)(D,{control:y.control,name:"acceptsInheritance",render:e=>{let{field:a}=e;return(0,r.jsxs)(F,{className:"flex flex-row items-center justify-between rounded-lg border p-3 shadow-sm bg-background",children:[(0,r.jsxs)("div",{className:"space-y-0.5",children:[(0,r.jsx)(_,{children:"Da li se prihvata nasljedstva?"}),(0,r.jsx)(O,{children:"Ako se živ nasljednik ne prihvata, njegov dio dijele ostali. Preminuli ne mogu prihvatiti."})]}),(0,r.jsx)(T,{children:(0,r.jsx)(W,{checked:a.value,onCheckedChange:a.onChange,disabled:!w,"aria-label":"Da li se prihvata nasljedstva"})})]})}}),"SPOUSE"===R&&w&&M&&(0,r.jsx)(D,{control:y.control,name:"requestSeparateHalf",render:e=>{let{field:a}=e;return(0,r.jsxs)(F,{className:"flex flex-row items-center justify-between rounded-lg border p-3 shadow-sm bg-blue-50 dark:bg-blue-900/30 border-blue-300 dark:border-blue-700",children:[(0,r.jsxs)("div",{className:"space-y-0.5",children:[(0,r.jsxs)(_,{className:"text-blue-800 dark:text-blue-300 flex items-center",children:[(0,r.jsx)(ei.A,{className:"mr-2 h-4 w-4"})," Da li traži izdvajanje polovine?"]}),(0,r.jsx)(O,{className:"text-blue-700 dark:text-blue-400",children:"Ako supružnik ovo zatraži, dobija 1/2 imovine odmah, a ostatak se dijeli zakonski."})]}),(0,r.jsx)(T,{children:(0,r.jsx)(W,{checked:a.value,onCheckedChange:a.onChange,"aria-label":"Da li supružnik traži izdvajanje polovine"})})]})}}),(0,r.jsxs)("div",{className:"flex justify-end space-x-2 pt-2",children:[(0,r.jsx)(u,{type:"button",variant:"ghost",onClick:()=>{h(!1),y.reset()},children:"Odustani"}),(0,r.jsx)(u,{type:"submit",children:"Sačuvaj Nasljednika"})]})]})})]})]}),f&&(0,r.jsx)(eA,{isOpen:j,onClose:E,onAddDescendant:e=>{if(f){let a={...e,relationship:"CHILD",id:Date.now().toString(),acceptsInheritance:!!e.isAlive&&e.acceptsInheritance,requestSeparateHalf:!1,descendants:[]};c(e=>eM(e,f.id,a)),E()}},parentName:f.name})]})}let e_=n.forwardRef((e,a)=>{let{className:t,...n}=e;return(0,r.jsx)("div",{className:"relative w-full overflow-auto",children:(0,r.jsx)("table",{ref:a,className:(0,c.cn)("w-full caption-bottom text-sm",t),...n})})});e_.displayName="Table";let eT=n.forwardRef((e,a)=>{let{className:t,...n}=e;return(0,r.jsx)("thead",{ref:a,className:(0,c.cn)("[&_tr]:border-b",t),...n})});eT.displayName="TableHeader";let eO=n.forwardRef((e,a)=>{let{className:t,...n}=e;return(0,r.jsx)("tbody",{ref:a,className:(0,c.cn)("[&_tr:last-child]:border-0",t),...n})});eO.displayName="TableBody",n.forwardRef((e,a)=>{let{className:t,...n}=e;return(0,r.jsx)("tfoot",{ref:a,className:(0,c.cn)("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",t),...n})}).displayName="TableFooter";let eC=n.forwardRef((e,a)=>{let{className:t,...n}=e;return(0,r.jsx)("tr",{ref:a,className:(0,c.cn)("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",t),...n})});eC.displayName="TableRow";let ez=n.forwardRef((e,a)=>{let{className:t,...n}=e;return(0,r.jsx)("th",{ref:a,className:(0,c.cn)("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",t),...n})});ez.displayName="TableHead";let eG=n.forwardRef((e,a)=>{let{className:t,...n}=e;return(0,r.jsx)("td",{ref:a,className:(0,c.cn)("p-4 align-middle [&:has([role=checkbox])]:pr-0",t),...n})});eG.displayName="TableCell",n.forwardRef((e,a)=>{let{className:t,...n}=e;return(0,r.jsx)("caption",{ref:a,className:(0,c.cn)("mt-4 text-sm text-muted-foreground",t),...n})}).displayName="TableCaption";var eH=t(1467),eL=t(4755),eU=t(5938);let eV={SPOUSE:"Supružnik",CHILD:"Dijete",PARENT:"Roditelj",PATERNAL_GRANDFATHER:"Djed (očeva strana)",PATERNAL_GRANDMOTHER:"Baba (očeva strana)",MATERNAL_GRANDFATHER:"Djed (majcina strana)",MATERNAL_GRANDMOTHER:"Baba (majcina strana)",PGF_F:"Pradjed (otac očevog oca)",PGF_M:"Prababa (majka očevog oca)",PGM_F:"Pradjed (otac očeve majke)",PGM_M:"Prababa (majka očeve majke)",MGF_F:"Pradjed (otac majčinog oca)",MGF_M:"Prababa (majka majčinog oca)",MGM_F:"Pradjed (otac majčine majke)",MGM_M:"Prababa (majka majčine majke)"},eq=e=>e?0===e.denominator||isNaN(e.numerator)||isNaN(e.denominator)?"Greška":0===e.numerator?"0":1===e.denominator?e.numerator.toString():"".concat(e.numerator,"/").concat(e.denominator):"0",eB=e=>Object.values(e).some(e=>(null==e?void 0:e.numerator)>0&&(null==e?void 0:e.denominator)>0),eJ=e=>{let{isAlive:a,acceptsInheritance:t,requestSeparateHalf:n}=e,s=[];return a?t?(s.push((0,r.jsx)(Z,{children:(0,r.jsxs)(K,{children:[(0,r.jsx)(X,{asChild:!0,children:(0,r.jsx)(es.A,{className:"ml-1 h-4 w-4 text-green-600 inline-block cursor-help"})}),(0,r.jsx)($,{children:(0,r.jsx)("p",{children:"Prihvata nasljedstvo"})})]})},"accepts")),n&&s.push((0,r.jsx)(Z,{children:(0,r.jsxs)(K,{children:[(0,r.jsx)(X,{asChild:!0,children:(0,r.jsx)(ei.A,{className:"ml-1 h-4 w-4 text-blue-600 inline-block cursor-help"})}),(0,r.jsx)($,{children:(0,r.jsx)("p",{children:"Traži izdvajanje polovine"})})]})},"separateHalf"))):s.push((0,r.jsx)(Z,{children:(0,r.jsxs)(K,{children:[(0,r.jsx)(X,{asChild:!0,children:(0,r.jsx)(eo.A,{className:"ml-1 h-4 w-4 text-destructive inline-block cursor-help"})}),(0,r.jsx)($,{children:(0,r.jsx)("p",{children:"Ne prihvata nasljedstvo"})})]})},"rejects")):s.push((0,r.jsx)(Z,{children:(0,r.jsxs)(K,{children:[(0,r.jsx)(X,{asChild:!0,children:(0,r.jsx)(en.A,{className:"ml-1 h-4 w-4 text-muted-foreground inline-block cursor-help"})}),(0,r.jsx)($,{children:(0,r.jsx)("p",{children:"Preminuo/la"})})]})},"deceased")),(0,r.jsx)(r.Fragment,{children:s})},eW=function(e,a){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,s=[];return e.forEach(e=>{s.push({heir:e,displayLevel:t,parent:r,grandParent:n}),e.descendants&&e.descendants.length>0&&(s=s.concat(eW(e.descendants,a,t+1,e,r)))}),s};function eY(e){let{results:a,heirs:t,deceasedName:n,donationRules:s,heirTaxes:i}=e,o=eB(a),l=eW(t,t),d=new Map(ew(t).map(e=>[e.id,e])),c=e=>{let a=[];return e.forEach(e=>{e.isAlive&&e.acceptsInheritance&&a.push(e),e.descendants&&(a=a.concat(c(e.descendants)))}),a},m=c(t).length>0;return(0,r.jsxs)(z,{className:"mt-6 shadow-md border-accent/50 print-section print:mt-0 print:shadow-none print:border-none print:rounded-none",children:[(0,r.jsxs)(G,{className:"bg-accent/5 rounded-t-lg print:border-b print:pb-2 print:mb-4",children:[(0,r.jsxs)(H,{className:"text-xl md:text-2xl font-semibold text-accent flex items-center print:text-lg print:text-black",children:[(0,r.jsx)(eH.A,{className:"mr-2 h-6 w-6 print:hidden"})," Rezultati Nasljedstva za: ",(0,r.jsx)("span",{className:"ml-1 font-bold",children:n})]}),(0,r.jsx)(L,{className:"print:text-sm print:text-gray-600",children:"Prikaz izračunatih nasljednih dijelova svedenih na zajednički imenilac."})]}),(0,r.jsxs)(U,{className:"pt-4 print:p-0",children:[(0,r.jsxs)(e_,{className:"print:text-xs",children:[(0,r.jsx)(eT,{children:(0,r.jsxs)(eC,{className:"bg-secondary/50 print:bg-white",children:[(0,r.jsx)(ez,{className:"print:p-1",children:"Nasljednik"}),(0,r.jsx)(ez,{className:"print:p-1 print:hidden md:table-cell",children:"Status"}),(0,r.jsx)(ez,{className:"print:p-1",children:"Odnos/Veza"}),(0,r.jsx)(ez,{className:"text-right print:p-1",children:"Nasljedni Dio"}),i&&(0,r.jsx)(ez,{className:"text-right print:p-1",children:"Sudska Taksa"})]})}),(0,r.jsx)(eO,{children:l.length>0?l.map(e=>{let t=e.heir,n=a[t.id]||{numerator:0,denominator:1},s=n.numerator>0,o=eJ({isAlive:t.isAlive,acceptsInheritance:t.acceptsInheritance,requestSeparateHalf:t.requestSeparateHalf}),l=i?i[t.id]:void 0,d=eV[t.relationship];if(e.displayLevel>0&&"CHILD"===t.relationship){let a=e.parent,t=e.grandParent;if(a){let e=a.relationship,r=a.name;d="CHILD"===e?t&&"CHILD"===t.relationship?"Praunuk/a (od ".concat(r,", unuk/a od ").concat(t.name,")"):null===t&&"CHILD"===e?"Unuk/a (od ".concat(r,")"):"Potomak (od ".concat(r,")"):"PARENT"===e?"Brat/Sestra (od ".concat(r,")"):e.includes("GRANDFATHER")||e.includes("GRANDMOTHER")?"Ujak/Stric/Tetka (potomak od ".concat(r,")"):e.startsWith("PGF_")||e.startsWith("PGM_")||e.startsWith("MGF_")||e.startsWith("MGM_")?"Potomak pradjeda/babe (od ".concat(r,")"):"Potomak (od ".concat(r,")")}else d="Potomak"}return(0,r.jsxs)(eC,{className:"".concat(s||!t.isAlive||t.acceptsInheritance?"":"text-muted-foreground opacity-60"," hover:bg-secondary/30 print:break-inside-avoid"),children:[(0,r.jsxs)(eG,{className:"font-medium ".concat(s||!t.isAlive&&(t.descendants||[]).some(e=>{var t;return(null===(t=a[e.id])||void 0===t?void 0:t.numerator)>0})?"":"text-muted-foreground"," print:p-1 py-2"),children:[e.displayLevel>0&&(0,r.jsxs)("span",{style:{paddingLeft:"".concat(.75*e.displayLevel,"rem")},className:"inline-flex items-center",children:[(0,r.jsx)(el.A,{className:"mr-1 h-3 w-3 text-muted-foreground print:hidden"}),(0,r.jsx)("span",{className:s?"font-semibold":"",children:t.name})]}),0===e.displayLevel&&(0,r.jsx)("span",{className:s?"font-semibold":"",children:t.name})]}),(0,r.jsx)(eG,{className:"print:hidden md:table-cell py-2",children:o}),(0,r.jsx)(eG,{className:"".concat(s||!t.isAlive&&(t.descendants||[]).some(e=>{var t;return(null===(t=a[e.id])||void 0===t?void 0:t.numerator)>0})?"":"text-muted-foreground opacity-80"," print:p-1 py-2"),children:d}),(0,r.jsxs)(eG,{className:"text-right font-semibold flex items-center justify-end ".concat(s?"text-accent print:text-black":"text-muted-foreground"," print:p-1 py-2"),children:[(0,r.jsx)("span",{className:"tabular-nums",children:eq(n)}),s&&(0,r.jsx)(eL.A,{className:"ml-1 h-4 w-4 opacity-60 print:hidden"})]}),i&&(0,r.jsx)(eG,{className:"text-right tabular-nums ".concat(s?"text-accent print:text-black":"text-muted-foreground"," print:p-1 py-2"),children:"number"==typeof l?l.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2}):s?"0.00":"-"})]},t.id)}):(0,r.jsx)(eC,{children:(0,r.jsxs)(eG,{colSpan:i?5:4,className:"text-center text-muted-foreground py-4 print:p-1",children:[m?"Niko od navedenih nema pravo na nasljedstvo ili se niko nije prihvatio nasljedstva.":"Nema unesenih nasljednika.",!o&&m&&" Imovina može pripasti Republici Srpskoj."]})})})]}),s.length>0&&(0,r.jsxs)("div",{className:"mt-6 p-4 border-t border-dashed print:mt-4 print:break-before-page",children:[(0,r.jsxs)("h4",{className:"text-md font-semibold mb-2 flex items-center text-primary print:text-base print:mb-1",children:[(0,r.jsx)(eU.A,{className:"mr-2 h-4 w-4 print:hidden"})," Prikaz Ustupanja Dijelova"]}),(0,r.jsx)("ul",{className:"space-y-1.5 text-sm list-none print:text-xs",children:s.map(e=>{var a,t;let n=(null===(a=d.get(e.donorId))||void 0===a?void 0:a.name)||"Nepoznat",s=(null===(t=d.get(e.recipientId))||void 0===t?void 0:t.name)||"Nepoznat";return(0,r.jsxs)("li",{className:"print:break-inside-avoid flex items-center gap-1 text-muted-foreground",children:[(0,r.jsx)("span",{className:"font-medium text-foreground",children:n}),(0,r.jsx)(eU.A,{className:"h-3 w-3 text-muted-foreground flex-shrink-0"}),(0,r.jsx)("span",{className:"font-medium text-foreground",children:s}),(0,r.jsxs)("span",{className:"ml-1",children:["(",eq(e.portionOfShare)," ",(0,r.jsx)("span",{className:"italic text-xs",children:"donatorovog dijela"}),")"]})]},e.id)})})]}),(0,r.jsx)("div",{className:"mt-4 px-4 pb-4 print:mt-4 print:p-0 print:max-w-full",children:(0,r.jsx)("p",{className:"text-sm text-muted-foreground text-center italic print:text-xs",children:"Ovaj programčić je u testnoj fazi te pruža samo indikativne rezultate nasljeđivanja i ni na koji način ne garantuje tačnost dobijenih podataka. Takođe, on nije namijenjen za složene situacije, nema pojma šta je nužni dio ili šta je nedostojnost nasljeđivanja i sl."})})]})]})}var eZ=t(1949),eK=t(594);function eX(e,a){return(e=Math.abs(Math.round(e)),a=Math.abs(Math.round(a)),isNaN(e)||isNaN(a))?1:0===a?e:eX(a,e%a)}function e$(e,a){return(e=Math.abs(Math.round(e)),a=Math.abs(Math.round(a)),isNaN(e)||isNaN(a))?1:0===e||0===a?0:Math.abs(e*a)/eX(e,a)}function eQ(e){if(!e||0===e.numerator)return{numerator:0,denominator:1};let a=Math.round(e.numerator),t=Math.round(e.denominator);if(0===t||isNaN(a)||isNaN(t))return console.error("Invalid input in simplifyFraction:",e),{numerator:0,denominator:1};let r=eX(Math.abs(a),Math.abs(t)),n=Math.abs(t/r);return{numerator:a/r*(t<0&&0!==a?-1:1),denominator:n}}function e0(e,a){e||(e={numerator:0,denominator:1}),a||(a={numerator:0,denominator:1});let t=e$(e.denominator,a.denominator);return 0===t||isNaN(t)||0===e.denominator||0===a.denominator?(console.error("Invalid common denominator or input denominator in addFractions",e,a,t),{numerator:0,denominator:1}):eQ({numerator:e.numerator*(t/e.denominator)+a.numerator*(t/a.denominator),denominator:t})}function e1(e,a){e||(e={numerator:0,denominator:1}),a||(a={numerator:0,denominator:1});let t=e$(e.denominator,a.denominator);return 0===t||isNaN(t)||0===e.denominator||0===a.denominator?(console.error("Invalid common denominator or input denominator in subtractFractions",e,a,t),{numerator:0,denominator:1}):eQ({numerator:e.numerator*(t/e.denominator)-a.numerator*(t/a.denominator),denominator:t})}function e4(e,a){return(e||(e={numerator:0,denominator:1}),a||(a={numerator:0,denominator:1}),0===e.denominator||0===a.denominator)?(console.error("Invalid denominator in multiplyFractions",e,a),{numerator:0,denominator:1}):eQ({numerator:e.numerator*a.numerator,denominator:e.denominator*a.denominator})}function e2(e,a){return(e||(e={numerator:0,denominator:1}),0===a||isNaN(a))?(console.error("Division by zero or NaN in divideFractionByNumber",a),{numerator:0,denominator:1}):0===e.denominator?(console.error("Invalid denominator in divideFractionByNumber",e),{numerator:0,denominator:1}):eQ({numerator:e.numerator,denominator:e.denominator*a})}function e5(e,a){if(!e||!a||void 0===e.numerator||void 0===e.denominator||void 0===a.numerator||void 0===a.denominator||0===e.denominator||0===a.denominator)return e&&0===e.numerator&&e.denominator>0&&a&&0===a.numerator&&a.denominator>0?0:e&&0===e.denominator&&a&&0!==a.denominator?1:a&&0===a.denominator&&e&&0!==e.denominator?-1:0;let t=e.numerator*a.denominator,r=a.numerator*e.denominator;return t>r?1:t<r?-1:0}function e3(e){let a=[];return e.forEach(e=>{a.push(e),e.descendants&&(a=a.concat(e3(e.descendants)))}),a}let e6={numerator:0,denominator:1},e8={numerator:1,denominator:2},e9={numerator:1,denominator:1};function e7(e){let a={};return Object.keys(e).forEach(t=>{a[t]=eQ(e[t]||e6)}),a}let ae=e=>e&&e.isAlive&&e.acceptsInheritance,aa=e=>!!e&&!e.isAlive&&!!e.descendants&&0!==e.descendants.length&&e.descendants.some(e=>ae(e)||aa(e));function at(e,a,t){let r=(e.descendants||[]).filter(e=>ae(e)),n=(e.descendants||[]).filter(e=>!e.isAlive&&aa(e)),s=r.length+n.length;if(0===s)return;let i=e2(a,s);r.forEach(e=>{t[e.id]=e0(t[e.id]||e6,i)}),n.forEach(e=>{at(e,i,t)})}function ar(e,a,t,r){let n=ae(t)||aa(t),s=ae(r)||aa(r),i=e2(e,2);n&&s?(ae(t)&&t?a[t.id]=e0(a[t.id]||e6,i):aa(t)&&t&&at(t,i,a),ae(r)&&r?a[r.id]=e0(a[r.id]||e6,i):aa(r)&&r&&at(r,i,a)):n?ae(t)&&t?a[t.id]=e0(a[t.id]||e6,e):aa(t)&&t&&at(t,e,a):s&&(ae(r)&&r?a[r.id]=e0(a[r.id]||e6,e):aa(r)&&r&&at(r,e,a))}function an(e,a,t,r){let n=arguments.length>4&&void 0!==arguments[4]&&arguments[4],s=ae(t)||aa(t),i=ae(r)||aa(r);if(!s&&!i)return!1;if(n)return!0;if(s&&i){let n=e4(e,e8);ae(t)&&t?a[t.id]=e0(a[t.id]||e6,n):aa(t)&&t&&at(t,n,a),ae(r)&&r?a[r.id]=e0(a[r.id]||e6,n):aa(r)&&r&&at(r,n,a)}else s?ae(t)&&t?a[t.id]=e0(a[t.id]||e6,e):aa(t)&&t&&at(t,e,a):i&&(ae(r)&&r?a[r.id]=e0(a[r.id]||e6,e):aa(r)&&r&&at(r,e,a));return!0}function as(e,a,t,r,n,s){let i=arguments.length>6&&void 0!==arguments[6]&&arguments[6],o=e4(e,e8),l=an(o,{},t,r,!0),d=an(o,{},n,s,!0);return i?l||d:l&&d?(an(o,a,t,r,!1),an(o,a,n,s,!1),!0):l?(an(e,a,t,r,!1),!0):!!d&&(an(e,a,n,s,!1),!0)}let ai=(0,d.F)("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),ao=n.forwardRef((e,a)=>{let{className:t,variant:n,...s}=e;return(0,r.jsx)("div",{ref:a,role:"alert",className:(0,c.cn)(ai({variant:n}),t),...s})});ao.displayName="Alert";let al=n.forwardRef((e,a)=>{let{className:t,...n}=e;return(0,r.jsx)("h5",{ref:a,className:(0,c.cn)("mb-1 font-medium leading-none tracking-tight",t),...n})});al.displayName="AlertTitle";let ad=n.forwardRef((e,a)=>{let{className:t,...n}=e;return(0,r.jsx)("div",{ref:a,className:(0,c.cn)("text-sm [&_p]:leading-relaxed",t),...n})});ad.displayName="AlertDescription";let ac=o.Yj().regex(/^\s*\d+\s*\/\s*\d+\s*$/,{message:"Format: 'brojilac / imenilac' (npr. '1 / 2')"}).transform((e,a)=>{let t=e.split("/").map(e=>e.trim()),r=parseInt(t[0],10),n=parseInt(t[1],10);return isNaN(r)||isNaN(n)||n<=0||r<0?(a.addIssue({code:o.eq.custom,message:"Neispravan razlomak. Brojilac mora biti >= 0, imenilac > 0."}),o.tm):r>n?(a.addIssue({code:o.eq.custom,message:"Brojilac ne može biti veći od imenioca za ovaj unos."}),o.tm):{numerator:r,denominator:n}}),am=o.Ik({donorId:o.Yj().min(1,{message:"Molimo izaberite donatora."}),recipientId:o.Yj().min(1,{message:"Molimo izaberite primaoca."}),portionOfShare:ac}).refine(e=>e.donorId!==e.recipientId,{message:"Donator i primalac ne mogu biti ista osoba.",path:["recipientId"]}),au={numerator:1,denominator:1},ap={numerator:0,denominator:1},ah=(e,a)=>{let t=e.find(e=>e.id===a);return t?t.name:"Nepoznat"},aj=e=>{if(!e||void 0===e.numerator||void 0===e.denominator)return"0/1";let a=eQ(e);return 0===a.denominator?"N/A":0===a.numerator?"0":1===a.denominator&&0!==a.numerator?a.numerator.toString():"".concat(a.numerator,"/").concat(a.denominator)};function ax(e){var a,t,o;let{eligibleHeirs:l,donationRules:d,setDonationRules:c,initialShares:m}=e,[h,j]=(0,n.useState)(!1),[x,f]=(0,n.useState)(null),g=0===l.length,y=(0,s.mN)({resolver:(0,i.u)(am),defaultValues:{donorId:"",recipientId:"",portionOfShare:"0 / 1"},mode:"onChange"}),{setError:w,clearErrors:R,formState:{errors:M},watch:S,setValue:I,reset:E}=y,V=S("donorId"),B=S("portionOfShare");(0,n.useEffect)(()=>{if(V&&m){let e=m[V]||ap,a=ap;d.forEach(e=>{e.donorId===V&&(a=e0(a,e.portionOfShare))});let t=e1(au,a=eQ(a));f({initialAbsoluteShare:eQ(e),totalRelativePortionAllocatedByDonor:a,maxRelativePortionForNewRule:eQ(t.numerator<0?ap:t),isFullyAllocated:e5(a,au)>=0})}else f(null)},[V,m,d]),(0,n.useEffect)(()=>{var e,a;if((null===(e=M.portionOfShare)||void 0===e?void 0:e.type)==="invalid_string"||(null===(a=M.portionOfShare)||void 0===a?void 0:a.type)==="custom")return;R("portionOfShare");let t=ac.safeParse(B);if(!t.success)return;let r=t.data;if(x){let e=x.maxRelativePortionForNewRule;x.isFullyAllocated&&r.numerator>0&&0===e5(x.totalRelativePortionAllocatedByDonor,au)?w("portionOfShare",{type:"manual_fully_allocated",message:"Donator je već alocirao 100% svog dijela. Unesite '0 / 1' ili izmijenite postojeća pravila."}):e5(r,e)>0&&w("portionOfShare",{type:"manual_exceeds_remaining_share",message:"Ne možete dodijeliti više od preostalog dijela donatora (".concat(aj(e)," njegovog početnog udjela).")})}},[B,x,M.portionOfShare,w,R]);let J=e=>{c(a=>a.filter(a=>a.id!==e))},W=null!==(o=(null==x?void 0:x.isFullyAllocated)&&0===e5(x.totalRelativePortionAllocatedByDonor,au))&&void 0!==o&&o;return(0,r.jsxs)(z,{className:"mt-6 border-primary/30 shadow",children:[(0,r.jsxs)(G,{className:"bg-primary/5 rounded-t-md",children:[(0,r.jsxs)(H,{className:"text-lg flex items-center",children:[(0,r.jsx)(eU.A,{className:"mr-2 h-5 w-5 text-primary"})," Preraspodjela Nasljednih Dijelova (Opciono)"]}),(0,r.jsx)(L,{children:"Definišite kako nasljednici ustupaju svoje dijelove drugim nasljednicima. Ustupiti mogu samo živi nasljednici koji prihvataju nasljedstvo i imaju dio veći od nule. Ako donator odluči da ustupi dio svog nasljedstva, **mora ustupiti cjelokupan svoj nasljedni dio** jednom ili više primalaca. Unesite dio **početnog udjela DONATORA** koji se ustupa svakom primaocu (npr. '1/2' ako donator ustupa polovinu svog dijela tom primaocu). Zbir svih ustupljenih dijelova od strane jednog donatora mora biti tačno 100% (ili 1/1) njegovog početnog udjela da bi ustupanje bilo važeće."})]}),(0,r.jsxs)(U,{className:"pt-4",children:[d.length>0&&(0,r.jsx)(q,{className:"h-36 mb-4 border rounded-md p-2 bg-secondary/20",children:(0,r.jsx)("ul",{className:"space-y-2",children:d.map(e=>(0,r.jsxs)("li",{className:"flex items-center justify-between p-2 rounded-md bg-card border border-border",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-1 text-sm flex-wrap gap-x-1",children:[(0,r.jsx)("span",{className:"font-medium",children:ah(l,e.donorId)}),(0,r.jsx)(eU.A,{className:"h-3 w-3 text-muted-foreground"}),(0,r.jsx)("span",{className:"font-medium",children:ah(l,e.recipientId)}),(0,r.jsxs)("span",{className:"text-muted-foreground ml-1 whitespace-nowrap",children:["(",aj(e.portionOfShare)," ",(0,r.jsx)("span",{className:"italic text-xs",children:"donatorovog dijela"}),")"]})]}),(0,r.jsx)(u,{variant:"ghost",size:"icon",onClick:()=>J(e.id),"aria-label":"Ukloni pravilo ".concat(e.id),children:(0,r.jsx)(ec.A,{className:"h-4 w-4 text-destructive hover:text-destructive/80"})})]},e.id))})}),!h&&(0,r.jsxs)(u,{onClick:()=>{j(!0),E({donorId:"",recipientId:"",portionOfShare:"0 / 1"}),f(null),R()},variant:"outline",className:"w-full border-primary/50 text-primary hover:bg-primary/10 hover:text-primary",disabled:g&&!!m,children:[(0,r.jsx)(ed.A,{className:"mr-2 h-4 w-4"})," Dodaj Pravilo Preraspodjele"]}),h&&g&&!!m&&(0,r.jsxs)(ao,{variant:"default",className:"my-4 bg-yellow-50 border-yellow-300 text-yellow-800 dark:bg-yellow-900/30 dark:border-yellow-700 dark:text-yellow-300",children:[(0,r.jsx)(eZ.A,{className:"h-5 w-5 !text-yellow-600 dark:!text-yellow-400"}),(0,r.jsx)(al,{className:"font-semibold",children:"Nema dostupnih donatora"}),(0,r.jsx)(ad,{children:"Nijedan nasljednik trenutno ne ispunjava uslove da ustupi svoj dio. Donator mora biti živ, prihvatiti nasljedstvo i imati nasljedni dio veći od nule nakon početnog obračuna."})]}),h&&(0,r.jsx)(P,{...y,children:(0,r.jsxs)("form",{onSubmit:y.handleSubmit(function(e){let a={id:Date.now().toString(),donorId:e.donorId,recipientId:e.recipientId,portionOfShare:e.portionOfShare};c(e=>[...e,a]),E({donorId:V,recipientId:"",portionOfShare:"0 / 1"})}),className:"space-y-4 p-4 border border-dashed border-primary/50 rounded-md bg-secondary/50 mt-4",children:[!g&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(D,{control:y.control,name:"donorId",render:e=>{let{field:a}=e;return(0,r.jsxs)(F,{children:[(0,r.jsx)(_,{children:"Donator (Ko ustupa dio)"}),(0,r.jsxs)(v,{onValueChange:e=>{a.onChange(e),I("portionOfShare","0 / 1"),I("recipientId",""),R("portionOfShare")},value:a.value||"",children:[(0,r.jsx)(T,{children:(0,r.jsx)(N,{"aria-required":"true",children:(0,r.jsx)(b,{placeholder:"Izaberite donatora"})})}),(0,r.jsx)(k,{children:l.map(e=>{var a,t;return(0,r.jsxs)(A,{value:e.id,disabled:!m||(null===(a=m[e.id])||void 0===a?void 0:a.numerator)===0,children:[e.name," ",m&&(null===(t=m[e.id])||void 0===t?void 0:t.numerator)!==0?"(".concat(aj(m?m[e.id]:ap)," ukupno)"):"(nema udjela)"]},e.id)})})]}),(0,r.jsx)(C,{})]})}}),x&&V&&m&&(null===(a=m[V])||void 0===a?void 0:a.numerator)!==0&&(0,r.jsxs)(z,{className:"p-3 text-sm border ".concat(x.isFullyAllocated&&0!==e5(x.totalRelativePortionAllocatedByDonor,au)?"bg-red-50 dark:bg-red-900/30 border-red-300 dark:border-red-700":"bg-blue-50 dark:bg-blue-900/20 border-blue-200 dark:border-blue-800"),children:[(0,r.jsx)(G,{className:"p-0 mb-2",children:(0,r.jsxs)(H,{className:"text-base flex items-center ".concat(x.isFullyAllocated&&0!==e5(x.totalRelativePortionAllocatedByDonor,au)?"text-red-700 dark:text-red-300":"text-blue-700 dark:text-blue-300"),children:[x.isFullyAllocated&&0!==e5(x.totalRelativePortionAllocatedByDonor,au)?(0,r.jsx)(eZ.A,{size:16,className:"mr-2"}):(0,r.jsx)(eK.A,{size:16,className:"mr-2"}),"Status alokacije za: ",ah(l,V)]})}),(0,r.jsxs)(U,{className:"p-0 space-y-1 ".concat(x.isFullyAllocated&&0!==e5(x.totalRelativePortionAllocatedByDonor,au)?"text-red-600 dark:text-red-400":"text-blue-600 dark:text-blue-400"),children:[(0,r.jsxs)("p",{children:["Početni udio donatora: ",(0,r.jsx)("span",{className:"font-semibold",children:aj(x.initialAbsoluteShare)})," ",(0,r.jsx)("span",{className:"italic text-xs",children:"cjelokupne zaostavštine."})]}),(0,r.jsxs)("p",{children:["Do sada alocirano (drugim pravilima): ",(0,r.jsx)("span",{className:"font-semibold",children:aj(x.totalRelativePortionAllocatedByDonor)})," ",(0,r.jsx)("span",{className:"italic text-xs",children:"donatorovog početnog udjela."})]}),x.isFullyAllocated?0===e5(x.totalRelativePortionAllocatedByDonor,au)?(0,r.jsx)("p",{className:"font-semibold text-green-700 dark:text-green-400",children:"Donator je alocirao 100% svog dijela."}):(0,r.jsxs)("p",{className:"font-semibold",children:["Donator NIJE ISPRAVNO alocirao 100% svog dijela (trenutno: ",aj(x.totalRelativePortionAllocatedByDonor),"). Njegove donacije neće biti važeće."]}):(0,r.jsxs)("p",{children:["Preostalo za alokaciju: ",(0,r.jsx)("span",{className:"font-semibold",children:aj(x.maxRelativePortionForNewRule)})," ",(0,r.jsx)("span",{className:"italic text-xs",children:"donatorovog početnog udjela."})]}),0!==e5(x.totalRelativePortionAllocatedByDonor,au)&&(0,r.jsx)("p",{className:"text-amber-700 dark:text-amber-500 font-medium",children:"UPOZORENJE: Da bi ustupanje bilo važeće, zbir svih ustupljenih dijelova ovog donatora mora biti tačno 100% (1/1) njegovog početnog udjela."})]})]}),(0,r.jsx)(D,{control:y.control,name:"recipientId",render:e=>{var a;let{field:t}=e;return(0,r.jsxs)(F,{children:[(0,r.jsx)(_,{children:"Primalac (Kome se ustupa dio)"}),(0,r.jsxs)(v,{onValueChange:t.onChange,value:t.value||"",disabled:!V||m&&(null===(a=m[V])||void 0===a?void 0:a.numerator)===0,children:[(0,r.jsx)(T,{children:(0,r.jsx)(N,{"aria-required":"true",children:(0,r.jsx)(b,{placeholder:"Izaberite primaoca"})})}),(0,r.jsx)(k,{children:l.filter(e=>e.id!==y.watch("donorId")).map(e=>(0,r.jsx)(A,{value:e.id,children:e.name},e.id))})]}),(0,r.jsx)(C,{})]})}}),(0,r.jsx)(D,{control:y.control,name:"portionOfShare",render:e=>{var a;let{field:{onChange:t,value:n,...s}}=e,i="object"==typeof n?"".concat(n.numerator," / ").concat(n.denominator):n;return(0,r.jsxs)(F,{children:[(0,r.jsxs)(_,{className:"flex items-center",children:["Dio Donatorovog Udjela Koji Se Ustupa ",(0,r.jsx)(eL.A,{className:"ml-1 h-3 w-3 opacity-70"})]}),(0,r.jsx)(T,{children:(0,r.jsx)(p,{placeholder:"Npr. 1 / 2 (za polovinu DJELA DONATORA)",value:i,onChange:e=>t(e.target.value),"aria-required":"true",...s,disabled:W||!V||m&&(null===(a=m[V])||void 0===a?void 0:a.numerator)===0})}),(0,r.jsx)(O,{children:"Unesite dio **početnog udjela donatora** koji se ustupa ovom primaocu (npr. '1/2' ako donator ustupa polovinu svog dijela). Ako je donator već alocirao 100% svog dijela, možete unijeti samo '0 / 1'."}),(0,r.jsx)(C,{})]})}})]}),(0,r.jsxs)("div",{className:"flex justify-end space-x-2 pt-2",children:[(0,r.jsx)(u,{type:"button",variant:"ghost",onClick:()=>{j(!1),E({donorId:"",recipientId:"",portionOfShare:"0 / 1"}),f(null),R()},children:"Zatvori Formu"}),!g&&(0,r.jsx)(u,{type:"submit",disabled:!y.formState.isValid||!V||m&&(null===(t=m[V])||void 0===t?void 0:t.numerator)===0||(null==x?void 0:x.isFullyAllocated)&&0!==e5(x.totalRelativePortionAllocatedByDonor,au),children:"Sačuvaj Pravilo"})]})]})})]})]})}var af=t(7481),av=t(9876),ab=t(3005),aN=t(7649);let ag=aN.bL,ay=aN.l9,ak=aN.ZL,aA=n.forwardRef((e,a)=>{let{className:t,...n}=e;return(0,r.jsx)(aN.hJ,{className:(0,c.cn)("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",t),...n,ref:a})});aA.displayName=aN.hJ.displayName;let aw=n.forwardRef((e,a)=>{let{className:t,...n}=e;return(0,r.jsxs)(ak,{children:[(0,r.jsx)(aA,{}),(0,r.jsx)(aN.UC,{ref:a,className:(0,c.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",t),...n})]})});aw.displayName=aN.UC.displayName;let aR=e=>{let{className:a,...t}=e;return(0,r.jsx)("div",{className:(0,c.cn)("flex flex-col space-y-2 text-center sm:text-left",a),...t})};aR.displayName="AlertDialogHeader";let aM=e=>{let{className:a,...t}=e;return(0,r.jsx)("div",{className:(0,c.cn)("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",a),...t})};aM.displayName="AlertDialogFooter";let aP=n.forwardRef((e,a)=>{let{className:t,...n}=e;return(0,r.jsx)(aN.hE,{ref:a,className:(0,c.cn)("text-lg font-semibold",t),...n})});aP.displayName=aN.hE.displayName;let aS=n.forwardRef((e,a)=>{let{className:t,...n}=e;return(0,r.jsx)(aN.VY,{ref:a,className:(0,c.cn)("text-sm text-muted-foreground",t),...n})});aS.displayName=aN.VY.displayName;let aD=n.forwardRef((e,a)=>{let{className:t,...n}=e;return(0,r.jsx)(aN.rc,{ref:a,className:(0,c.cn)(m(),t),...n})});aD.displayName=aN.rc.displayName;let aI=n.forwardRef((e,a)=>{let{className:t,...n}=e;return(0,r.jsx)(aN.ZD,{ref:a,className:(0,c.cn)(m({variant:"outline"}),"mt-2 sm:mt-0",t),...n})});function aE(){let[e,a]=(0,n.useState)(""),[t,s]=(0,n.useState)([]),[i,o]=(0,n.useState)(null),[l,d]=(0,n.useState)([]),[c,m]=(0,n.useState)(null),[h,j]=(0,n.useState)(!1),[x,f]=(0,n.useState)(!1),[v,b]=(0,n.useState)(""),[N,g]=(0,n.useState)(null),{toast:y}=(0,af.dj)(),k=(0,n.useCallback)(()=>{if(!e.trim()){y({title:"Greška",description:"Molimo unesite ime ostavioca.",variant:"destructive"});return}if(0===t.length){y({title:"Informacija",description:"Nema unesenih nasljednika za obračun.",variant:"default"}),o({}),m({}),g(null),f(!1);return}let a=function(e){let a={},t=e9;e3(e).forEach(e=>{a[e.id]=e6});let r=e.find(e=>"SPOUSE"===e.relationship&&ae(e)&&!0===e.requestSeparateHalf);if(r&&(a[r.id]=e0(a[r.id]||e6,e8),t=e1(t,e8)),t.numerator<=0&&t.denominator>0)return e7(a);let n=e.find(e=>"SPOUSE"===e.relationship&&ae(e)),s=e.filter(e=>"CHILD"===e.relationship&&ae(e)),i=e.filter(e=>"CHILD"===e.relationship&&aa(e));if(s.length>0||i.length>0){let e=s.length+i.length;if(n&&e++,e>0){let r=e2(t,e);n&&(a[n.id]=e0(a[n.id]||e6,r)),s.forEach(e=>{a[e.id]=e0(a[e.id]||e6,r)}),i.forEach(e=>{at(e,r,a)})}return e7(a)}let o=e.filter(e=>"PARENT"===e.relationship),l=o.filter(e=>ae(e)),d=o.filter(e=>aa(e));if(n&&0===l.length&&0===d.length)return a[n.id]=e0(a[n.id]||e6,t),e7(a);if(l.length>0||d.length>0){let e=n?e4(t,e8):t;n&&(a[n.id]=e0(a[n.id]||e6,e4(t,e8)));let r=[...l,...d];if(1===r.length){let t=r[0];ae(t)?a[t.id]=e0(a[t.id]||e6,e):aa(t)&&at(t,e,a)}else if(2===r.length){let t=e2(e,2);r.forEach(e=>{ae(e)?a[e.id]=e0(a[e.id]||e6,t):aa(e)&&at(e,t,a)})}else if(2===o.length&&1===l.length&&0===d.length){let t=l[0];a[t.id]=e0(a[t.id]||e6,e)}return e7(a)}let c=e.find(e=>"PATERNAL_GRANDFATHER"===e.relationship),m=e.find(e=>"PATERNAL_GRANDMOTHER"===e.relationship),u=e.find(e=>"MATERNAL_GRANDFATHER"===e.relationship),p=e.find(e=>"MATERNAL_GRANDMOTHER"===e.relationship),h=ae(c)||aa(c)||ae(m)||aa(m),j=ae(u)||aa(u)||ae(p)||aa(p);if(n&&!h&&!j)return a[n.id]=e0(a[n.id]||e6,t),e7(a);if(h||j){let e=n?e4(t,e8):t;if(n&&(a[n.id]=e0(a[n.id]||e6,e4(t,e8))),h&&j){let t=e4(e,e8);ar(t,a,c,m),ar(t,a,u,p)}else h?ar(e,a,c,m):j&&ar(e,a,u,p);return e7(a)}let x=e.find(e=>"PGF_F"===e.relationship),f=e.find(e=>"PGF_M"===e.relationship),v=e.find(e=>"PGM_F"===e.relationship),b=e.find(e=>"PGM_M"===e.relationship),N=e.find(e=>"MGF_F"===e.relationship),g=e.find(e=>"MGF_M"===e.relationship),y=e.find(e=>"MGM_F"===e.relationship),k=e.find(e=>"MGM_M"===e.relationship),A=as(e9,{},x,f,v,b,!0),w=as(e9,{},N,g,y,k,!0);if(n&&!A&&!w)return a[n.id]=e0(a[n.id]||e6,t),e7(a);if(A||w){let e=n?e4(t,e8):t;if(n&&(a[n.id]=e0(a[n.id]||e6,e4(t,e8))),A&&w){let t=e4(e,e8);as(t,a,x,f,v,b,!1),as(t,a,N,g,y,k,!1)}else A?as(e,a,x,f,v,b,!1):w&&as(e,a,N,g,y,k,!1);return e7(a)}return n&&!r&&0===e.filter(e=>"SPOUSE"!==e.relationship&&(ae(e)||aa(e))).length&&(a[n.id]=e0(a[n.id]||e6,t)),e7(a)}(t);m(a);let{finalShares:r,warnings:n}=function(e,a,t){var r,n;let s={...e},i=[],o=new Map(e3(t).map(e=>[e.id,e])),l={};for(let t of a)e[t.donorId]&&0!==e[t.donorId].numerator&&(l[t.donorId]||(l[t.donorId]={totalRelativeAllocated:e6,isValid:!1}),l[t.donorId].totalRelativeAllocated=e0(l[t.donorId].totalRelativeAllocated,t.portionOfShare));for(let e in l){let a=l[e];if(a.totalRelativeAllocated=eQ(a.totalRelativeAllocated),0===e5(a.totalRelativeAllocated,e9))a.isValid=!0;else{a.isValid=!1;let t=(null===(r=o.get(e))||void 0===r?void 0:r.name)||"Donator ID: ".concat(e);i.push({type:"donor_incomplete_allocation",donorName:t,message:"".concat(t," nije preraspodijelio/la tačno 100% svog dijela (alocirano: ").concat(function(e){if(!e)return"N/A";let a=eQ(e);return"".concat(a.numerator,"/").concat(a.denominator)}(a.totalRelativeAllocated),"). Njegove/njene donacije neće biti primijenjene.")})}}for(let t of a){let a=t.donorId,r=t.recipientId;if((null===(n=l[a])||void 0===n?void 0:n.isValid)&&e[a]&&e[a].numerator>0){let n=e[a];0===e5(s[a],n)&&(s[a]=e6);let i=e4(n,t.portionOfShare);s[r]=e0(s[r]||e6,i)}}for(let e in s)s[e]=eQ(s[e]);return{finalShares:s,warnings:i}}(a,l,t);n.forEach(e=>{y({title:"Upozorenje o Preraspodjeli",description:e.message,variant:"donor_incomplete_allocation"===e.type?"destructive":"default",duration:7e3})}),o(function(e){let a={},t={},r=Object.keys(e);r.forEach(a=>{t[a]=eQ(e[a]||e6)});let n=Object.values(t).map(e=>null==e?void 0:e.denominator).filter(e=>"number"==typeof e&&e>0);if(0===n.length)return r.forEach(e=>{a[e]=t[e]||e6}),a;let s=function(e){if(!e||0===e.length)return 1;let a=e.filter(e=>"number"==typeof e&&!isNaN(e)&&e>0);return 0===a.length?1:a.reduce((e,a)=>e$(e,a),1)}(n);return s<=0||isNaN(s)?(console.error("Invalid common denominator calculated:",s,"Denominators:",n),r.forEach(e=>{a[e]=t[e]||e6})):r.forEach(e=>{let r=t[e];if(!r||"number"!=typeof r.numerator||"number"!=typeof r.denominator||isNaN(r.numerator)||isNaN(r.denominator)||r.denominator<=0||0===r.numerator){a[e]={numerator:0,denominator:s};return}let n=s/r.denominator;!Number.isFinite(n)||isNaN(n)?(console.error("Invalid multiplier for heir ".concat(e,". Orig (simplified): ").concat(r.numerator,"/").concat(r.denominator,", Common Den: ").concat(s,", Multiplier: ").concat(n)),a[e]={numerator:0,denominator:s}):a[e]={numerator:Math.round(r.numerator*n),denominator:s}}),a}(r)),g(null),f(!1)},[t,l,e,y]);return(0,n.useEffect)(()=>{(i||c&&Object.keys(c).length>0)&&k()},[t,l,e]),(0,n.useEffect)(()=>{i||(g(null),f(!1),b(""))},[i]),(0,r.jsxs)("div",{className:"min-h-screen bg-background text-foreground flex flex-col items-center p-4 md:p-8",children:[(0,r.jsxs)("header",{className:"w-full max-w-4xl mb-6 md:mb-10 text-center",children:[(0,r.jsx)("div",{className:"flex items-center justify-center mb-2 text-primary",children:(0,r.jsx)(av.A,{size:50,className:"text-primary"})}),(0,r.jsx)("h1",{className:"text-3xl md:text-4xl font-bold text-primary",children:"Kalkulator nasljedstva"})]}),(0,r.jsxs)("main",{className:"w-full max-w-4xl space-y-6",children:[(0,r.jsx)(eF,{onAddHeir:e=>{s(a=>[...a,e]),o(null),m(null),d([]),g(null),f(!1)},heirs:t,onRemoveHeir:e=>{s(eR(t,e)),o(null),m(null),g(null),f(!1),d(a=>a.filter(a=>a.donorId!==e&&a.recipientId!==e))},deceasedName:e,setDeceasedName:a,setHeirs:s}),t.length>0&&c&&Object.keys(c).length>0&&(0,r.jsx)(ax,{eligibleHeirs:c?ew(t).filter(e=>e.isAlive&&e.acceptsInheritance&&c[e.id]&&c[e.id].numerator>0):[],donationRules:l,setDonationRules:d,initialShares:c}),(0,r.jsxs)("div",{className:"flex flex-col sm:flex-row justify-between items-center gap-4 mt-6 print-hidden",children:[(0,r.jsx)(u,{onClick:k,size:"lg",className:"w-full sm:w-auto bg-accent hover:bg-accent-hover text-accent-foreground px-8 py-3 text-lg shadow-md",disabled:!e.trim(),children:"Izračunaj Nasljedstvo"}),(0,r.jsxs)(ag,{open:h,onOpenChange:j,children:[(0,r.jsx)(ay,{asChild:!0,children:(0,r.jsx)(u,{variant:"destructive",size:"lg",className:"w-full sm:w-auto px-8 py-3 text-lg shadow-md",children:"Resetuj Sve Podatke"})}),(0,r.jsxs)(aw,{children:[(0,r.jsxs)(aR,{children:[(0,r.jsx)(aP,{children:"Potvrda resetovanja"}),(0,r.jsx)(aS,{children:"Da li ste sigurni da želite da obrišete sve unesene podatke o ostaviocu, nasljednicima i pravilima preraspodjele? Ova akcija se ne može opozvati."})]}),(0,r.jsxs)(aM,{children:[(0,r.jsx)(aI,{onClick:()=>j(!1),children:"Odustani"}),(0,r.jsx)(aD,{onClick:()=>{a(""),s([]),o(null),d([]),m(null),j(!1),g(null),f(!1),b(""),y({title:"Resetovano",description:"Svi podaci su obrisani."})},children:"Obriši Sve"})]})]})]})]}),i&&(0,r.jsx)(eY,{results:i,heirs:t,deceasedName:e,donationRules:l,heirTaxes:N}),i&&Object.keys(i).length>0&&!N&&!x&&(0,r.jsx)("div",{className:"mt-6 flex justify-center print-hidden",children:(0,r.jsxs)(u,{variant:"outline",onClick:()=>f(!0),className:"text-primary border-primary/50 hover:bg-[hsl(var(--primary-hover))] hover:text-primary-foreground",children:[(0,r.jsx)(ab.A,{className:"mr-2 h-4 w-4"})," Želite li da izračunate i sudske takse za nasljednike?"]})}),x&&(0,r.jsxs)(z,{className:"mt-6 print-hidden border-primary/30 shadow",children:[(0,r.jsxs)(G,{className:"bg-primary/5 rounded-t-md",children:[(0,r.jsxs)(H,{className:"text-lg flex items-center",children:[(0,r.jsx)(ab.A,{className:"mr-2 h-5 w-5 text-primary"}),"Obračun Sudske Takse"]}),(0,r.jsx)(L,{children:"Unesite ukupan iznos sudske takse koja će biti raspoređena na nasljednike srazmjerno njihovim dijelovima."})]}),(0,r.jsxs)(U,{className:"pt-4 space-y-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)(M,{htmlFor:"totalTaxAmount",className:"mb-2 block",children:"Ukupan iznos sudske takse"}),(0,r.jsx)(p,{id:"totalTaxAmount",type:"number",value:v,onChange:e=>b(e.target.value),placeholder:"Unesite ukupan iznos takse",className:"w-full"})]}),(0,r.jsxs)("div",{className:"flex justify-end space-x-2",children:[(0,r.jsx)(u,{variant:"ghost",onClick:()=>{f(!1),b("")},children:"Odustani"}),(0,r.jsx)(u,{onClick:()=>{let e=parseFloat(v);if(isNaN(e)||e<0){y({title:"Greška",description:"Molimo unesite validan ukupan iznos takse.",variant:"destructive"});return}if(!i){y({title:"Greška",description:"Prvo izračunajte nasljedne dijelove.",variant:"destructive"});return}let a={},r=0,n=1;if(Object.values(i).forEach(e=>{e&&e.denominator>0&&(n=e.denominator,r+=e.numerator)}),0===n||0===r){ew(t).forEach(e=>{a[e.id]=0}),g(a),f(!1),y({title:"Obračun Taksi",description:"Takse su obračunate (0 jer nema nasljednog dijela)."});return}for(let t in i){let r=i[t];if(r&&r.numerator>0&&r.denominator>0){let n=r.numerator/r.denominator;a[t]=n*e}else a[t]=0}g(a),f(!1),y({title:"Obračun Taksi",description:"Sudske takse su uspješno obračunate."})},className:"bg-accent hover:bg-accent-hover text-accent-foreground",children:"Obračunaj takse"})]})]})]})]}),(0,r.jsx)("footer",{className:"w-full max-w-4xl mt-10 pt-6 border-t border-border text-center text-sm text-muted-foreground print-hidden",children:(0,r.jsx)("p",{children:"Napravljeno sa ljubavlju za kolege Osnovnog suda u Foči. E-mail za sugestije: dragan.osfoca@gmail.com."})})]})}aI.displayName=aN.ZD.displayName},7481:(e,a,t)=>{"use strict";t.d(a,{dj:()=>u});var r=t(2115);let n=0,s=new Map,i=e=>{if(s.has(e))return;let a=setTimeout(()=>{s.delete(e),c({type:"REMOVE_TOAST",toastId:e})},1e6);s.set(e,a)},o=(e,a)=>{switch(a.type){case"ADD_TOAST":return{...e,toasts:[a.toast,...e.toasts].slice(0,1)};case"UPDATE_TOAST":return{...e,toasts:e.toasts.map(e=>e.id===a.toast.id?{...e,...a.toast}:e)};case"DISMISS_TOAST":{let{toastId:t}=a;return t?i(t):e.toasts.forEach(e=>{i(e.id)}),{...e,toasts:e.toasts.map(e=>e.id===t||void 0===t?{...e,open:!1}:e)}}case"REMOVE_TOAST":if(void 0===a.toastId)return{...e,toasts:[]};return{...e,toasts:e.toasts.filter(e=>e.id!==a.toastId)}}},l=[],d={toasts:[]};function c(e){d=o(d,e),l.forEach(e=>{e(d)})}function m(e){let{...a}=e,t=(n=(n+1)%Number.MAX_SAFE_INTEGER).toString(),r=()=>c({type:"DISMISS_TOAST",toastId:t});return c({type:"ADD_TOAST",toast:{...a,id:t,open:!0,onOpenChange:e=>{e||r()}}}),{id:t,dismiss:r,update:e=>c({type:"UPDATE_TOAST",toast:{...e,id:t}})}}function u(){let[e,a]=r.useState(d);return r.useEffect(()=>(l.push(a),()=>{let e=l.indexOf(a);e>-1&&l.splice(e,1)}),[e]),{...e,toast:m,dismiss:e=>c({type:"DISMISS_TOAST",toastId:e})}}},9434:(e,a,t)=>{"use strict";t.d(a,{cn:()=>s});var r=t(2596),n=t(9688);function s(){for(var e=arguments.length,a=Array(e),t=0;t<e;t++)a[t]=arguments[t];return(0,n.QP)((0,r.$)(a))}}},e=>{var a=a=>e(e.s=a);e.O(0,[426,294,441,684,358],()=>a(4948)),_N_E=e.O()}]);