(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{4948:(e,a,t)=>{Promise.resolve().then(t.bind(t,5432))},5432:(e,a,t)=>{"use strict";t.r(a),t.d(a,{default:()=>aT});var r=t(5155),n=t(2115),i=t(2177),s=t(221),o=t(1153),l=t(9708),d=t(2085),c=t(9434);let m=(0,d.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-[hsl(var(--primary-hover))]",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),u=n.forwardRef((e,a)=>{let{className:t,variant:n,size:i,asChild:s=!1,...o}=e,d=s?l.DX:"button";return(0,r.jsx)(d,{className:(0,c.cn)(m({variant:n,size:i,className:t})),ref:a,...o})});u.displayName="Button";let p=n.forwardRef((e,a)=>{let{className:t,type:n,...i}=e;return(0,r.jsx)("input",{type:n,className:(0,c.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",t),ref:a,...i})});p.displayName="Input";var h=t(1992),f=t(9556),j=t(7381),x=t(518);let v=h.bL;h.YJ;let N=h.WT,b=n.forwardRef((e,a)=>{let{className:t,children:n,...i}=e;return(0,r.jsxs)(h.l9,{ref:a,className:(0,c.cn)("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",t),...i,children:[n,(0,r.jsx)(h.In,{asChild:!0,children:(0,r.jsx)(f.A,{className:"h-4 w-4 opacity-50"})})]})});b.displayName=h.l9.displayName;let g=n.forwardRef((e,a)=>{let{className:t,...n}=e;return(0,r.jsx)(h.PP,{ref:a,className:(0,c.cn)("flex cursor-default items-center justify-center py-1",t),...n,children:(0,r.jsx)(j.A,{className:"h-4 w-4"})})});g.displayName=h.PP.displayName;let A=n.forwardRef((e,a)=>{let{className:t,...n}=e;return(0,r.jsx)(h.wn,{ref:a,className:(0,c.cn)("flex cursor-default items-center justify-center py-1",t),...n,children:(0,r.jsx)(f.A,{className:"h-4 w-4"})})});A.displayName=h.wn.displayName;let y=n.forwardRef((e,a)=>{let{className:t,children:n,position:i="popper",...s}=e;return(0,r.jsx)(h.ZL,{children:(0,r.jsxs)(h.UC,{ref:a,className:(0,c.cn)("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2","popper"===i&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",t),position:i,...s,children:[(0,r.jsx)(g,{}),(0,r.jsx)(h.LM,{className:(0,c.cn)("p-1","popper"===i&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:n}),(0,r.jsx)(A,{})]})})});y.displayName=h.UC.displayName,n.forwardRef((e,a)=>{let{className:t,...n}=e;return(0,r.jsx)(h.JU,{ref:a,className:(0,c.cn)("py-1.5 pl-8 pr-2 text-sm font-semibold",t),...n})}).displayName=h.JU.displayName;let k=n.forwardRef((e,a)=>{let{className:t,children:n,...i}=e;return(0,r.jsxs)(h.q7,{ref:a,className:(0,c.cn)("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t),...i,children:[(0,r.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,r.jsx)(h.VF,{children:(0,r.jsx)(x.A,{className:"h-4 w-4"})})}),(0,r.jsx)(h.p4,{children:n})]})});k.displayName=h.q7.displayName,n.forwardRef((e,a)=>{let{className:t,...n}=e;return(0,r.jsx)(h.wv,{ref:a,className:(0,c.cn)("-mx-1 my-1 h-px bg-muted",t),...n})}).displayName=h.wv.displayName;var w=t(968);let R=(0,d.F)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),P=n.forwardRef((e,a)=>{let{className:t,...n}=e;return(0,r.jsx)(w.b,{ref:a,className:(0,c.cn)(R(),t),...n})});P.displayName=w.b.displayName;let E=i.Op,M=n.createContext({}),I=e=>{let{...a}=e;return(0,r.jsx)(M.Provider,{value:{name:a.name},children:(0,r.jsx)(i.xI,{...a})})},S=()=>{let e=n.useContext(M),a=n.useContext(D),{getFieldState:t,formState:r}=(0,i.xW)(),s=t(e.name,r);if(!e)throw Error("useFormField should be used within <FormField>");let{id:o}=a;return{id:o,name:e.name,formItemId:"".concat(o,"-form-item"),formDescriptionId:"".concat(o,"-form-item-description"),formMessageId:"".concat(o,"-form-item-message"),...s}},D=n.createContext({}),F=n.forwardRef((e,a)=>{let{className:t,...i}=e,s=n.useId();return(0,r.jsx)(D.Provider,{value:{id:s},children:(0,r.jsx)("div",{ref:a,className:(0,c.cn)("space-y-2",t),...i})})});F.displayName="FormItem";let _=n.forwardRef((e,a)=>{let{className:t,...n}=e,{error:i,formItemId:s}=S();return(0,r.jsx)(P,{ref:a,className:(0,c.cn)(i&&"text-destructive",t),htmlFor:s,...n})});_.displayName="FormLabel";let T=n.forwardRef((e,a)=>{let{...t}=e,{error:n,formItemId:i,formDescriptionId:s,formMessageId:o}=S();return(0,r.jsx)(l.DX,{ref:a,id:i,"aria-describedby":n?"".concat(s," ").concat(o):"".concat(s),"aria-invalid":!!n,...t})});T.displayName="FormControl";let O=n.forwardRef((e,a)=>{let{className:t,...n}=e,{formDescriptionId:i}=S();return(0,r.jsx)("p",{ref:a,id:i,className:(0,c.cn)("text-sm text-muted-foreground",t),...n})});O.displayName="FormDescription";let C=n.forwardRef((e,a)=>{var t;let{className:n,children:i,...s}=e,{error:o,formMessageId:l}=S(),d=o?String(null!==(t=null==o?void 0:o.message)&&void 0!==t?t:""):i;return d?(0,r.jsx)("p",{ref:a,id:l,className:(0,c.cn)("text-sm font-medium text-destructive",n),...s,children:d}):null});C.displayName="FormMessage";let G=n.forwardRef((e,a)=>{let{className:t,...n}=e;return(0,r.jsx)("div",{ref:a,className:(0,c.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",t),...n})});G.displayName="Card";let z=n.forwardRef((e,a)=>{let{className:t,...n}=e;return(0,r.jsx)("div",{ref:a,className:(0,c.cn)("flex flex-col space-y-1.5 p-6",t),...n})});z.displayName="CardHeader";let H=n.forwardRef((e,a)=>{let{className:t,...n}=e;return(0,r.jsx)("div",{ref:a,className:(0,c.cn)("text-2xl font-semibold leading-none tracking-tight",t),...n})});H.displayName="CardTitle";let L=n.forwardRef((e,a)=>{let{className:t,...n}=e;return(0,r.jsx)("div",{ref:a,className:(0,c.cn)("text-sm text-muted-foreground",t),...n})});L.displayName="CardDescription";let U=n.forwardRef((e,a)=>{let{className:t,...n}=e;return(0,r.jsx)("div",{ref:a,className:(0,c.cn)("p-6 pt-0",t),...n})});U.displayName="CardContent",n.forwardRef((e,a)=>{let{className:t,...n}=e;return(0,r.jsx)("div",{ref:a,className:(0,c.cn)("flex items-center p-6 pt-0",t),...n})}).displayName="CardFooter";var q=t(7655);let V=n.forwardRef((e,a)=>{let{className:t,children:n,...i}=e;return(0,r.jsxs)(q.bL,{ref:a,className:(0,c.cn)("relative overflow-hidden",t),...i,children:[(0,r.jsx)(q.LM,{className:"h-full w-full rounded-[inherit]",children:n}),(0,r.jsx)(B,{}),(0,r.jsx)(q.OK,{})]})});V.displayName=q.bL.displayName;let B=n.forwardRef((e,a)=>{let{className:t,orientation:n="vertical",...i}=e;return(0,r.jsx)(q.VM,{ref:a,orientation:n,className:(0,c.cn)("flex touch-none select-none transition-colors","vertical"===n&&"h-full w-2.5 border-l border-l-transparent p-[1px]","horizontal"===n&&"h-2.5 flex-col border-t border-t-transparent p-[1px]",t),...i,children:(0,r.jsx)(q.lr,{className:"relative flex-1 rounded-full bg-border"})})});B.displayName=q.VM.displayName;var J=t(4884);let W=n.forwardRef((e,a)=>{let{className:t,...n}=e;return(0,r.jsx)(J.bL,{className:(0,c.cn)("peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input",t),...n,ref:a,children:(0,r.jsx)(J.zi,{className:(0,c.cn)("pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0")})})});W.displayName=J.bL.displayName;var Y=t(9613);let Z=Y.Kq,K=Y.bL,X=Y.l9,$=n.forwardRef((e,a)=>{let{className:t,sideOffset:n=4,...i}=e;return(0,r.jsx)(Y.UC,{ref:a,sideOffset:n,className:(0,c.cn)("z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",t),...i})});$.displayName=Y.UC.displayName;var Q=t(8098),ee=t(8510),ea=t(3798),et=t(1474),er=t(1721),en=t(7270),ei=t(8376),es=t(3095),eo=t(4371),el=t(1429),ed=t(4301),ec=t(7223),em=t(286),eu=t(5452),ep=t(5318);let eh=eu.bL;eu.l9;let ef=eu.ZL,ej=eu.bm,ex=n.forwardRef((e,a)=>{let{className:t,...n}=e;return(0,r.jsx)(eu.hJ,{ref:a,className:(0,c.cn)("fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",t),...n})});ex.displayName=eu.hJ.displayName;let ev=n.forwardRef((e,a)=>{let{className:t,children:n,...i}=e;return(0,r.jsxs)(ef,{children:[(0,r.jsx)(ex,{}),(0,r.jsxs)(eu.UC,{ref:a,className:(0,c.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",t),...i,children:[n,(0,r.jsxs)(eu.bm,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[(0,r.jsx)(ep.A,{className:"h-4 w-4"}),(0,r.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})});ev.displayName=eu.UC.displayName;let eN=e=>{let{className:a,...t}=e;return(0,r.jsx)("div",{className:(0,c.cn)("flex flex-col space-y-1.5 text-center sm:text-left",a),...t})};eN.displayName="DialogHeader";let eb=e=>{let{className:a,...t}=e;return(0,r.jsx)("div",{className:(0,c.cn)("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",a),...t})};eb.displayName="DialogFooter";let eg=n.forwardRef((e,a)=>{let{className:t,...n}=e;return(0,r.jsx)(eu.hE,{ref:a,className:(0,c.cn)("text-lg font-semibold leading-none tracking-tight",t),...n})});eg.displayName=eu.hE.displayName;let eA=n.forwardRef((e,a)=>{let{className:t,...n}=e;return(0,r.jsx)(eu.VY,{ref:a,className:(0,c.cn)("text-sm text-muted-foreground",t),...n})});eA.displayName=eu.VY.displayName;let ey=o.Ik({name:o.Yj().min(1,{message:"Ime nasljednika je obavezno."}),relationship:o.eu("CHILD").default("CHILD"),isAlive:o.zM().default(!0),acceptsInheritance:o.zM().default(!0)}).refine(e=>e.isAlive||!e.acceptsInheritance,{message:"Preminuli nasljednik ne može prihvatiti nasljedstvo.",path:["acceptsInheritance"]});function ek(e){let{isOpen:a,onClose:t,onAddDescendant:o,parentName:l}=e,d=(0,i.mN)({resolver:(0,s.u)(ey),defaultValues:{name:"",relationship:"CHILD",isAlive:!0,acceptsInheritance:!0}}),c=d.watch("isAlive");return(0,n.useEffect)(()=>{c||d.setValue("acceptsInheritance",!1)},[c,d]),(0,n.useEffect)(()=>{a||d.reset()},[a,d]),(0,r.jsx)(eh,{open:a,onOpenChange:e=>!e&&t(),children:(0,r.jsxs)(ev,{className:"sm:max-w-[425px]",children:[(0,r.jsxs)(eN,{children:[(0,r.jsxs)(eg,{children:["Dodaj Nasljednika za ",l]}),(0,r.jsxs)(eA,{children:["Unesite podatke o djetetu preminulog nasljednika (",l,"). Oni će naslijediti njegov dio."]})]}),(0,r.jsx)(E,{...d,children:(0,r.jsxs)("form",{onSubmit:d.handleSubmit(function(e){o({name:e.name,relationship:e.relationship,isAlive:e.isAlive,acceptsInheritance:!!e.isAlive&&e.acceptsInheritance}),d.reset()}),className:"space-y-4 py-4",children:[(0,r.jsx)(I,{control:d.control,name:"name",render:e=>{let{field:a}=e;return(0,r.jsxs)(F,{children:[(0,r.jsx)(_,{children:"Ime Nasljednika (Potomka)"}),(0,r.jsx)(T,{children:(0,r.jsx)(p,{placeholder:"Npr. Petar Petrović",...a,"aria-required":"true"})}),(0,r.jsx)(C,{})]})}}),(0,r.jsx)(I,{control:d.control,name:"isAlive",render:e=>{let{field:a}=e;return(0,r.jsxs)(F,{className:"flex flex-row items-center justify-between rounded-lg border p-3 shadow-sm bg-secondary/90",children:[(0,r.jsxs)("div",{className:"space-y-0.5",children:[(0,r.jsx)(_,{children:"Da li je živ?"}),(0,r.jsx)(O,{children:"Status potomka."})]}),(0,r.jsx)(T,{children:(0,r.jsx)(W,{checked:a.value,onCheckedChange:a.onChange,"aria-label":"Da li je potomak živ"})})]})}}),(0,r.jsx)(I,{control:d.control,name:"acceptsInheritance",render:e=>{let{field:a}=e;return(0,r.jsxs)(F,{className:"flex flex-row items-center justify-between rounded-lg border p-3 shadow-sm bg-secondary/90",children:[(0,r.jsxs)("div",{className:"space-y-0.5",children:[(0,r.jsx)(_,{children:"Da li se prihvata nasljedstva?"}),(0,r.jsx)(O,{children:"Da li potomak prihvata dio nasljedstva."})]}),(0,r.jsx)(T,{children:(0,r.jsx)(W,{checked:a.value,onCheckedChange:a.onChange,disabled:!c,"aria-label":"Da li se potomak prihvata nasljedstva"})})]})}}),(0,r.jsxs)(eb,{children:[(0,r.jsx)(ej,{asChild:!0,children:(0,r.jsx)(u,{type:"button",variant:"ghost",children:"Odustani"})}),(0,r.jsx)(u,{type:"submit",children:"Sačuvaj Potomka"})]})]})})]})})}let ew=e=>{let a=[];return e.forEach(e=>{a.push(e),e.descendants&&(a=a.concat(ew(e.descendants)))}),a},eR=(e,a)=>e.filter(e=>e.id!==a).map(e=>e.descendants&&e.descendants.length>0?{...e,descendants:eR(e.descendants,a)}:e),eP=(e,a,t)=>e.map(e=>{if(e.id===a){let a={...t,acceptsInheritance:!!t.isAlive&&t.acceptsInheritance,descendants:t.descendants||[]};return{...e,descendants:[...e.descendants||[],a]}}return e.descendants&&e.descendants.length>0?{...e,descendants:eP(e.descendants,a,t)}:e}),eE=o.Ik({name:o.Yj().min(1,{message:"Ime nasljednika je obavezno."}),relationship:o.k5(["SPOUSE","CHILD","PARENT","PATERNAL_GRANDFATHER","PATERNAL_GRANDMOTHER","MATERNAL_GRANDFATHER","MATERNAL_GRANDMOTHER","PGF_F","PGF_M","PGM_F","PGM_M","MGF_F","MGF_M","MGM_F","MGM_M"],{required_error:"Odnos prema ostaviocu je obavezan."}),isAlive:o.zM().default(!0),acceptsInheritance:o.zM().default(!0),requestSeparateHalf:o.zM().optional().default(!1)}).refine(e=>e.isAlive||!e.acceptsInheritance,{message:"Preminuli nasljednik ne može prihvatiti nasljedstvo.",path:["acceptsInheritance"]}).refine(e=>"SPOUSE"!==e.relationship||!e.requestSeparateHalf||e.isAlive&&e.acceptsInheritance,{message:"Supružnik može tražiti izdvajanje polovine samo ako je živ i prihvata nasljedstvo.",path:["requestSeparateHalf"]}),eM={SPOUSE:"Supružnik",CHILD:"Dijete",PARENT:"Roditelj",PATERNAL_GRANDFATHER:"Djed (očeva strana)",PATERNAL_GRANDMOTHER:"Baba (očeva strana)",MATERNAL_GRANDFATHER:"Djed (majcina strana)",MATERNAL_GRANDMOTHER:"Baba (majcina strana)",PGF_F:"Pradjed (otac očevog oca)",PGF_M:"Prababa (majka očevog oca)",PGM_F:"Pradjed (otac očeve majke)",PGM_M:"Prababa (majka očeve majke)",MGF_F:"Pradjed (otac majčinog oca)",MGF_M:"Prababa (majka majčinog oca)",MGM_F:"Pradjed (otac majčine majke)",MGM_M:"Prababa (majka majčine majke)"},eI={SPOUSE:Q.A,CHILD:ee.A,PARENT:ea.A,PATERNAL_GRANDFATHER:et.A,PATERNAL_GRANDMOTHER:et.A,MATERNAL_GRANDFATHER:et.A,MATERNAL_GRANDMOTHER:et.A,PGF_F:et.A,PGF_M:et.A,PGM_F:et.A,PGM_M:et.A,MGF_F:et.A,MGF_M:et.A,MGM_F:et.A,MGM_M:et.A},eS=e=>{let{relationship:a}=e,t=eI[a]||er.A;return(0,r.jsx)(t,{className:"mr-2 h-4 w-4 text-muted-foreground"})},eD=e=>{let{isAlive:a,acceptsInheritance:t,requestSeparateHalf:n}=e,i=[];return a?t?(i.push((0,r.jsx)(Z,{children:(0,r.jsxs)(K,{children:[(0,r.jsx)(X,{asChild:!0,children:(0,r.jsx)(ei.A,{className:"ml-2 h-4 w-4 text-green-600 cursor-help"})}),(0,r.jsx)($,{children:(0,r.jsx)("p",{children:"Prihvata nasljedstvo"})})]})},"accepts")),n&&i.push((0,r.jsx)(Z,{children:(0,r.jsxs)(K,{children:[(0,r.jsx)(X,{asChild:!0,children:(0,r.jsx)(es.A,{className:"ml-1 h-4 w-4 text-blue-600 cursor-help"})}),(0,r.jsx)($,{children:(0,r.jsx)("p",{children:"Traži izdvajanje polovine"})})]})},"separateHalf"))):i.push((0,r.jsx)(Z,{children:(0,r.jsxs)(K,{children:[(0,r.jsx)(X,{asChild:!0,children:(0,r.jsx)(eo.A,{className:"ml-2 h-4 w-4 text-destructive cursor-help"})}),(0,r.jsx)($,{children:(0,r.jsx)("p",{children:"Ne prihvata nasljedstvo"})})]})},"rejects")):i.push((0,r.jsx)(Z,{children:(0,r.jsxs)(K,{children:[(0,r.jsx)(X,{asChild:!0,children:(0,r.jsx)(en.A,{className:"ml-2 h-4 w-4 text-muted-foreground cursor-help"})}),(0,r.jsx)($,{children:(0,r.jsx)("p",{children:"Preminuo/la"})})]})},"deceased")),(0,r.jsx)(r.Fragment,{children:i})};function eF(e){let{onAddHeir:a,heirs:t,onRemoveHeir:o,deceasedName:l,setDeceasedName:d,setHeirs:c}=e,[m,h]=(0,n.useState)(!1),[f,j]=(0,n.useState)(!1),[x,g]=(0,n.useState)(null),A=(0,i.mN)({resolver:(0,s.u)(eE),defaultValues:{name:"",relationship:void 0,isAlive:!0,acceptsInheritance:!0,requestSeparateHalf:!1}}),w=A.watch("isAlive"),R=A.watch("relationship"),P=A.watch("acceptsInheritance");(0,n.useEffect)(()=>{w||(A.setValue("acceptsInheritance",!1),A.setValue("requestSeparateHalf",!1)),"SPOUSE"!==R&&A.setValue("requestSeparateHalf",!1),"SPOUSE"!==R||P||A.setValue("requestSeparateHalf",!1)},[w,R,P,A]);let M=e=>{o(e)},S=e=>{g(e),j(!0)},D=()=>{g(null),j(!1)},q=e=>"CHILD"===e||"PARENT"===e||"PATERNAL_GRANDFATHER"===e||"PATERNAL_GRANDMOTHER"===e||"MATERNAL_GRANDFATHER"===e||"MATERNAL_GRANDMOTHER"===e||"PGF_F"===e||"PGF_M"===e||"PGM_F"===e||"PGM_M"===e||"MGF_F"===e||"MGF_M"===e||"MGM_F"===e||"MGM_M"===e,B=(e,a,t)=>{let r={};for(let a of t)if(function a(t,n,i){if(t.id===e)return r={heir:t,parent:n,grandParent:i},!0;if(t.descendants){for(let e of t.descendants)if(a(e,t,n))return!0}return!1}(a,null,null))break;return r},J=(0,n.useCallback)(e=>{let{heir:a,level:n=0}=e,i=eM[a.relationship];if(n>0&&"CHILD"===a.relationship){let e=B(a.id,t,t),r=e.parent,n=e.grandParent;if(r){let e=r.relationship,a=r.name;i="CHILD"===e?n&&"CHILD"===n.relationship?"Praunuk/a (od ".concat(a,", unuk/a od ").concat(n.name,")"):null===n&&"CHILD"===e?"Unuk/a (od ".concat(a,")"):"Potomak (od ".concat(a,")"):"PARENT"===e?"Brat/Sestra (od ".concat(a,")"):e.includes("GRANDFATHER")||e.includes("GRANDMOTHER")?"Ujak/Stric/Tetka (potomak od ".concat(a,")"):e.startsWith("PGF_")||e.startsWith("PGM_")||e.startsWith("MGF_")||e.startsWith("MGM_")?"Potomak pradjeda/babe (od ".concat(a,")"):"Potomak (od ".concat(a,")")}else i="Potomak"}return(0,r.jsxs)("li",{className:"flex flex-col p-2 rounded-md border ".concat(n>0?"ml-6 mt-1 bg-secondary/60 border-secondary":"bg-card border-border"),children:[(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"flex items-center flex-wrap gap-x-1",children:[n>0&&(0,r.jsx)(el.A,{className:"mr-1 h-3 w-3 text-muted-foreground flex-shrink-0"}),(0,r.jsx)(eS,{relationship:a.relationship}),(0,r.jsx)("span",{className:"font-medium",children:a.name}),(0,r.jsxs)("span",{className:"text-sm text-muted-foreground",children:["(",i,")"]}),(0,r.jsx)(eD,{isAlive:a.isAlive,acceptsInheritance:a.acceptsInheritance,requestSeparateHalf:a.requestSeparateHalf})]}),(0,r.jsxs)("div",{className:"flex items-center space-x-1 flex-shrink-0",children:[!a.isAlive&&q(a.relationship)&&(0,r.jsx)(Z,{children:(0,r.jsxs)(K,{children:[(0,r.jsx)(X,{asChild:!0,children:(0,r.jsx)(u,{variant:"ghost",size:"icon",onClick:()=>S(a),"aria-label":"Dodaj nasljednika za ".concat(a.name),children:(0,r.jsx)(ed.A,{className:"h-4 w-4 text-primary hover:text-[hsl(var(--primary-hover))]"})})}),(0,r.jsx)($,{children:(0,r.jsxs)("p",{children:["Dodaj potomka za ",a.name]})})]})}),(0,r.jsx)(u,{variant:"ghost",size:"icon",onClick:()=>M(a.id),"aria-label":"Ukloni ".concat(a.name),children:(0,r.jsx)(ec.A,{className:"h-4 w-4 text-destructive hover:text-destructive/80"})})]})]}),a.descendants&&a.descendants.length>0&&(0,r.jsx)("ul",{className:"mt-2 space-y-1 border-t border-dashed border-muted pt-2",children:a.descendants.map(e=>(0,r.jsx)(J,{heir:e,level:n+1},e.id))})]},a.id)},[t,c]);return(0,r.jsxs)("div",{className:"space-y-6 print-hidden",children:[(0,r.jsxs)(G,{className:"border-primary/30 shadow",children:[(0,r.jsx)(z,{className:"bg-primary/5 rounded-t-md",children:(0,r.jsxs)(H,{className:"text-lg flex items-center",children:[(0,r.jsx)(er.A,{className:"mr-2 h-5 w-5 text-primary"})," Podaci o ostaviocu"]})}),(0,r.jsxs)(U,{className:"pt-4",children:[(0,r.jsx)(p,{placeholder:"Ime i prezime ostavioca",value:l,onChange:e=>d(e.target.value),className:"mb-2","aria-label":"Ime i prezime ostavioca"}),(0,r.jsx)("p",{className:"text-sm text-muted-foreground",children:"Unesite ime osobe čije se nasljedstvo dijeli."})]})]}),(0,r.jsxs)(G,{className:"border-primary/30 shadow",children:[(0,r.jsxs)(z,{className:"bg-primary/5 rounded-t-md",children:[(0,r.jsxs)(H,{className:"text-lg flex items-center",children:[(0,r.jsx)(em.A,{className:"mr-2 h-5 w-5 text-primary"})," Nasljednici"]}),(0,r.jsx)(L,{children:"Dodajte sve potencijalne zakonske nasljednike. Za preminule nasljednike koji mogu imati potomke po pravu predstavljanja (djecu, roditelje, djedove/babe, pradjedove/prababe), dodajte njihove potomke klikom na ikonu plus. Program provjerava nasljedne redove: 1. Djeca/Supružnik; 2. Roditelji/Supružnik (i potomci roditelja - braća/sestre ostavioca); 3. Djedovi/Babe/Supružnik (i njihovi potomci - ujaci/stricevi/tetke ostavioca); 4. Pradjedovi/Prababe (i njihovi potomci)."})]}),(0,r.jsxs)(U,{className:"pt-4",children:[t.length>0&&(0,r.jsx)(V,{className:"h-48 mb-4 border rounded-md p-2 bg-secondary/20",children:(0,r.jsx)("ul",{className:"space-y-2",children:t.map(e=>(0,r.jsx)(J,{heir:e},e.id))})}),!m&&(0,r.jsxs)(u,{onClick:()=>h(!0),variant:"outline",className:"w-full border-primary/50 text-primary hover:bg-primary/10 hover:text-primary",children:[(0,r.jsx)(ed.A,{className:"mr-2 h-4 w-4"})," Dodaj Nasljednika"]}),m&&(0,r.jsx)(E,{...A,children:(0,r.jsxs)("form",{onSubmit:A.handleSubmit(function(e){a({...e,acceptsInheritance:!!e.isAlive&&e.acceptsInheritance,requestSeparateHalf:"SPOUSE"===e.relationship&&!!e.isAlive&&!!e.acceptsInheritance&&e.requestSeparateHalf,id:Date.now().toString(),descendants:[]}),A.reset(),h(!1)}),className:"space-y-4 p-4 border border-dashed border-primary/50 rounded-md bg-secondary/50 mt-4",children:[(0,r.jsx)(I,{control:A.control,name:"name",render:e=>{let{field:a}=e;return(0,r.jsxs)(F,{children:[(0,r.jsx)(_,{children:"Ime Nasljednika"}),(0,r.jsx)(T,{children:(0,r.jsx)(p,{placeholder:"Npr. Marko Marković",...a,"aria-required":"true"})}),(0,r.jsx)(C,{})]})}}),(0,r.jsx)(I,{control:A.control,name:"relationship",render:e=>{let{field:a}=e;return(0,r.jsxs)(F,{children:[(0,r.jsx)("div",{className:"flex items-center justify-between",children:(0,r.jsx)(_,{children:"Odnos prema Ostaviocu"})}),(0,r.jsxs)(v,{onValueChange:a.onChange,value:a.value||"",children:[(0,r.jsx)(T,{children:(0,r.jsx)(b,{"aria-required":"true",children:(0,r.jsx)(N,{placeholder:"Izaberite odnos"})})}),(0,r.jsx)(y,{children:Object.entries(eM).map(e=>{let[a,t]=e;return(0,r.jsx)(k,{value:a,children:t},a)})})]}),(0,r.jsx)(C,{})]})}}),(0,r.jsx)(I,{control:A.control,name:"isAlive",render:e=>{let{field:a}=e;return(0,r.jsxs)(F,{className:"flex flex-row items-center justify-between rounded-lg border p-3 shadow-sm bg-background",children:[(0,r.jsxs)("div",{className:"space-y-0.5",children:[(0,r.jsx)(_,{children:"Da li je nasljednik živ?"}),(0,r.jsx)(O,{children:"Ako nije živ, za određene srodnike moći ćete dodati njihove potomke nakon što sačuvate ovog nasljednika."})]}),(0,r.jsx)(T,{children:(0,r.jsx)(W,{checked:a.value,onCheckedChange:a.onChange,"aria-label":"Da li je nasljednik živ"})})]})}}),(0,r.jsx)(I,{control:A.control,name:"acceptsInheritance",render:e=>{let{field:a}=e;return(0,r.jsxs)(F,{className:"flex flex-row items-center justify-between rounded-lg border p-3 shadow-sm bg-background",children:[(0,r.jsxs)("div",{className:"space-y-0.5",children:[(0,r.jsx)(_,{children:"Da li se prihvata nasljedstva?"}),(0,r.jsx)(O,{children:"Ako se živ nasljednik ne prihvata, njegov dio dijele ostali. Preminuli ne mogu prihvatiti."})]}),(0,r.jsx)(T,{children:(0,r.jsx)(W,{checked:a.value,onCheckedChange:a.onChange,disabled:!w,"aria-label":"Da li se prihvata nasljedstva"})})]})}}),"SPOUSE"===R&&w&&P&&(0,r.jsx)(I,{control:A.control,name:"requestSeparateHalf",render:e=>{let{field:a}=e;return(0,r.jsxs)(F,{className:"flex flex-row items-center justify-between rounded-lg border p-3 shadow-sm bg-blue-50 dark:bg-blue-900/30 border-blue-300 dark:border-blue-700",children:[(0,r.jsxs)("div",{className:"space-y-0.5",children:[(0,r.jsxs)(_,{className:"text-blue-800 dark:text-blue-300 flex items-center",children:[(0,r.jsx)(es.A,{className:"mr-2 h-4 w-4"})," Da li traži izdvajanje polovine?"]}),(0,r.jsx)(O,{className:"text-blue-700 dark:text-blue-400",children:"Ako supružnik ovo zatraži, dobija 1/2 imovine odmah, a ostatak se dijeli zakonski."})]}),(0,r.jsx)(T,{children:(0,r.jsx)(W,{checked:a.value,onCheckedChange:a.onChange,"aria-label":"Da li supružnik traži izdvajanje polovine"})})]})}}),(0,r.jsxs)("div",{className:"flex justify-end space-x-2 pt-2",children:[(0,r.jsx)(u,{type:"button",variant:"ghost",onClick:()=>{h(!1),A.reset()},children:"Odustani"}),(0,r.jsx)(u,{type:"submit",children:"Sačuvaj Nasljednika"})]})]})})]})]}),x&&(0,r.jsx)(ek,{isOpen:f,onClose:D,onAddDescendant:e=>{if(x){let a={...e,relationship:"CHILD",id:Date.now().toString(),acceptsInheritance:!!e.isAlive&&e.acceptsInheritance,requestSeparateHalf:!1,descendants:[]};c(e=>eP(e,x.id,a)),D()}},parentName:x.name})]})}let e_=n.forwardRef((e,a)=>{let{className:t,...n}=e;return(0,r.jsx)("div",{className:"relative w-full overflow-auto",children:(0,r.jsx)("table",{ref:a,className:(0,c.cn)("w-full caption-bottom text-sm",t),...n})})});e_.displayName="Table";let eT=n.forwardRef((e,a)=>{let{className:t,...n}=e;return(0,r.jsx)("thead",{ref:a,className:(0,c.cn)("[&_tr]:border-b",t),...n})});eT.displayName="TableHeader";let eO=n.forwardRef((e,a)=>{let{className:t,...n}=e;return(0,r.jsx)("tbody",{ref:a,className:(0,c.cn)("[&_tr:last-child]:border-0",t),...n})});eO.displayName="TableBody",n.forwardRef((e,a)=>{let{className:t,...n}=e;return(0,r.jsx)("tfoot",{ref:a,className:(0,c.cn)("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",t),...n})}).displayName="TableFooter";let eC=n.forwardRef((e,a)=>{let{className:t,...n}=e;return(0,r.jsx)("tr",{ref:a,className:(0,c.cn)("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",t),...n})});eC.displayName="TableRow";let eG=n.forwardRef((e,a)=>{let{className:t,...n}=e;return(0,r.jsx)("th",{ref:a,className:(0,c.cn)("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",t),...n})});eG.displayName="TableHead";let ez=n.forwardRef((e,a)=>{let{className:t,...n}=e;return(0,r.jsx)("td",{ref:a,className:(0,c.cn)("p-4 align-middle [&:has([role=checkbox])]:pr-0",t),...n})});ez.displayName="TableCell",n.forwardRef((e,a)=>{let{className:t,...n}=e;return(0,r.jsx)("caption",{ref:a,className:(0,c.cn)("mt-4 text-sm text-muted-foreground",t),...n})}).displayName="TableCaption";var eH=t(1467),eL=t(4755),eU=t(5938);let eq={SPOUSE:"Supružnik",CHILD:"Dijete",PARENT:"Roditelj",PATERNAL_GRANDFATHER:"Djed (očeva strana)",PATERNAL_GRANDMOTHER:"Baba (očeva strana)",MATERNAL_GRANDFATHER:"Djed (majcina strana)",MATERNAL_GRANDMOTHER:"Baba (majcina strana)",PGF_F:"Pradjed (otac očevog oca)",PGF_M:"Prababa (majka očevog oca)",PGM_F:"Pradjed (otac očeve majke)",PGM_M:"Prababa (majka očeve majke)",MGF_F:"Pradjed (otac majčinog oca)",MGF_M:"Prababa (majka majčinog oca)",MGM_F:"Pradjed (otac majčine majke)",MGM_M:"Prababa (majka majčine majke)"},eV=e=>e?0===e.denominator||isNaN(e.numerator)||isNaN(e.denominator)?"Greška":0===e.numerator?"0":1===e.denominator?e.numerator.toString():"".concat(e.numerator,"/").concat(e.denominator):"0",eB=e=>Object.values(e).some(e=>(null==e?void 0:e.numerator)>0&&(null==e?void 0:e.denominator)>0),eJ=e=>{let{isAlive:a,acceptsInheritance:t,requestSeparateHalf:n}=e,i=[];return a?t?(i.push((0,r.jsx)(Z,{children:(0,r.jsxs)(K,{children:[(0,r.jsx)(X,{asChild:!0,children:(0,r.jsx)(ei.A,{className:"ml-1 h-4 w-4 text-green-600 inline-block cursor-help"})}),(0,r.jsx)($,{children:(0,r.jsx)("p",{children:"Prihvata nasljedstvo"})})]})},"accepts")),n&&i.push((0,r.jsx)(Z,{children:(0,r.jsxs)(K,{children:[(0,r.jsx)(X,{asChild:!0,children:(0,r.jsx)(es.A,{className:"ml-1 h-4 w-4 text-blue-600 inline-block cursor-help"})}),(0,r.jsx)($,{children:(0,r.jsx)("p",{children:"Traži izdvajanje polovine"})})]})},"separateHalf"))):i.push((0,r.jsx)(Z,{children:(0,r.jsxs)(K,{children:[(0,r.jsx)(X,{asChild:!0,children:(0,r.jsx)(eo.A,{className:"ml-1 h-4 w-4 text-destructive inline-block cursor-help"})}),(0,r.jsx)($,{children:(0,r.jsx)("p",{children:"Ne prihvata nasljedstvo"})})]})},"rejects")):i.push((0,r.jsx)(Z,{children:(0,r.jsxs)(K,{children:[(0,r.jsx)(X,{asChild:!0,children:(0,r.jsx)(en.A,{className:"ml-1 h-4 w-4 text-muted-foreground inline-block cursor-help"})}),(0,r.jsx)($,{children:(0,r.jsx)("p",{children:"Preminuo/la"})})]})},"deceased")),(0,r.jsx)(r.Fragment,{children:i})},eW=function(e){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,n=[];return e.forEach(e=>{n.push({heir:e,displayLevel:a,parent:t,grandParent:r}),e.descendants&&e.descendants.length>0&&(n=n.concat(eW(e.descendants,a+1,e,t)))}),n},eY=(e,a)=>{for(let t of e){if(t.id===a)return t;if(t.descendants){let e=eY(t.descendants,a);if(e)return e}}return null};function eZ(e){let{results:a,heirs:t,deceasedName:n,donationRules:i,heirTaxes:s}=e,o=eB(a),l=eW(t),d=e=>{let a=[];return e.forEach(e=>{e.isAlive&&e.acceptsInheritance&&a.push(e),e.descendants&&(a=a.concat(d(e.descendants)))}),a},c=d(t).length>0;return(0,r.jsxs)(G,{className:"mt-6 shadow-md border-accent/50 print-section print:mt-0 print:shadow-none print:border-none print:rounded-none",children:[(0,r.jsxs)(z,{className:"bg-accent/5 rounded-t-lg print:border-b print:pb-2 print:mb-4",children:[(0,r.jsxs)(H,{className:"text-xl md:text-2xl font-semibold text-accent flex items-center print:text-lg print:text-black",children:[(0,r.jsx)(eH.A,{className:"mr-2 h-6 w-6 print:hidden"})," Rezultati Nasljedstva za: ",(0,r.jsx)("span",{className:"ml-1 font-bold",children:n})]}),(0,r.jsx)(L,{className:"print:text-sm print:text-gray-600",children:"Prikaz izračunatih nasljednih dijelova svedenih na zajednički imenilac."})]}),(0,r.jsxs)(U,{className:"pt-4 print:p-0",children:[(0,r.jsxs)(e_,{className:"print:text-xs",children:[(0,r.jsx)(eT,{children:(0,r.jsxs)(eC,{className:"bg-secondary/50 print:bg-white",children:[(0,r.jsx)(eG,{className:"print:p-1",children:"Nasljednik"}),(0,r.jsx)(eG,{className:"print:p-1 print:hidden md:table-cell",children:"Status"}),(0,r.jsx)(eG,{className:"print:p-1",children:"Odnos/Veza"}),(0,r.jsx)(eG,{className:"text-right print:p-1",children:"Nasljedni Dio"}),s&&(0,r.jsx)(eG,{className:"text-right print:p-1",children:"Sudska Taksa"})]})}),(0,r.jsx)(eO,{children:l.length>0?l.map(e=>{let t=e.heir,n=a[t.id]||{numerator:0,denominator:1},i=n.numerator>0,o=eJ({isAlive:t.isAlive,acceptsInheritance:t.acceptsInheritance,requestSeparateHalf:t.requestSeparateHalf}),l=s?s[t.id]:void 0,d=eq[t.relationship];if(e.displayLevel>0&&"CHILD"===t.relationship){let a=e.parent,t=e.grandParent;if(a){let e=a.relationship,r=a.name;d="CHILD"===e?t&&"CHILD"===t.relationship?"Praunuk/a (od ".concat(r,", unuk/a od ").concat(t.name,")"):null===t&&"CHILD"===e?"Unuk/a (od ".concat(r,")"):"Potomak (od ".concat(r,")"):"PARENT"===e?"Brat/Sestra (od ".concat(r,")"):e.includes("GRANDFATHER")||e.includes("GRANDMOTHER")?"Ujak/Stric/Tetka (potomak od ".concat(r,")"):e.startsWith("PGF_")||e.startsWith("PGM_")||e.startsWith("MGF_")||e.startsWith("MGM_")?"Potomak pradjeda/babe (od ".concat(r,")"):"Potomak (od ".concat(r,")")}else d="Potomak"}return(0,r.jsxs)(eC,{className:"".concat(i||!t.isAlive||t.acceptsInheritance?"":"text-muted-foreground opacity-60"," hover:bg-secondary/30 print:break-inside-avoid"),children:[(0,r.jsxs)(ez,{className:"font-medium ".concat(i||!t.isAlive&&(t.descendants||[]).some(e=>{var t;return(null===(t=a[e.id])||void 0===t?void 0:t.numerator)>0})?"":"text-muted-foreground"," print:p-1 py-2"),children:[e.displayLevel>0&&(0,r.jsxs)("span",{style:{paddingLeft:"".concat(.75*e.displayLevel,"rem")},className:"inline-flex items-center",children:[(0,r.jsx)(el.A,{className:"mr-1 h-3 w-3 text-muted-foreground print:hidden"}),(0,r.jsx)("span",{className:i?"font-semibold":"",children:t.name})]}),0===e.displayLevel&&(0,r.jsx)("span",{className:i?"font-semibold":"",children:t.name})]}),(0,r.jsx)(ez,{className:"print:hidden md:table-cell py-2",children:o}),(0,r.jsx)(ez,{className:"".concat(i||!t.isAlive&&(t.descendants||[]).some(e=>{var t;return(null===(t=a[e.id])||void 0===t?void 0:t.numerator)>0})?"":"text-muted-foreground opacity-80"," print:p-1 py-2"),children:d}),(0,r.jsxs)(ez,{className:"text-right font-semibold flex items-center justify-end ".concat(i?"text-accent print:text-black":"text-muted-foreground"," print:p-1 py-2"),children:[(0,r.jsx)("span",{className:"tabular-nums",children:eV(n)}),i&&(0,r.jsx)(eL.A,{className:"ml-1 h-4 w-4 opacity-60 print:hidden"})]}),s&&(0,r.jsx)(ez,{className:"text-right tabular-nums ".concat(i?"text-accent print:text-black":"text-muted-foreground"," print:p-1 py-2"),children:"number"==typeof l?l.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2}):i?"0.00":"-"})]},t.id)}):(0,r.jsx)(eC,{children:(0,r.jsxs)(ez,{colSpan:s?5:4,className:"text-center text-muted-foreground py-4 print:p-1",children:[c?"Niko od navedenih nema pravo na nasljedstvo ili se niko nije prihvatio nasljedstva.":"Nema unesenih nasljednika.",!o&&c&&" Imovina može pripasti Republici Srpskoj."]})})})]}),i.length>0&&(0,r.jsxs)("div",{className:"mt-6 p-4 border-t border-dashed print:mt-4 print:break-before-page",children:[(0,r.jsxs)("h4",{className:"text-md font-semibold mb-2 flex items-center text-primary print:text-base print:mb-1",children:[(0,r.jsx)(eU.A,{className:"mr-2 h-4 w-4 print:hidden"})," Prikaz Ustupanja Dijelova"]}),(0,r.jsx)("ul",{className:"space-y-1.5 text-sm list-none print:text-xs",children:i.map(e=>{var a,n;let i=(null===(a=eY(t,e.donorId))||void 0===a?void 0:a.name)||"Nepoznat",s=(null===(n=eY(t,e.recipientId))||void 0===n?void 0:n.name)||"Nepoznat";return(0,r.jsxs)("li",{className:"print:break-inside-avoid flex items-center gap-1 text-muted-foreground",children:[(0,r.jsx)("span",{className:"font-medium text-foreground",children:i}),(0,r.jsx)(eU.A,{className:"h-3 w-3 text-muted-foreground flex-shrink-0"}),(0,r.jsx)("span",{className:"font-medium text-foreground",children:s}),(0,r.jsxs)("span",{className:"ml-1",children:["(",eV(e.portionOfShare)," ",(0,r.jsx)("span",{className:"italic text-xs",children:"donatorovog dijela"}),")"]})]},e.id)})})]}),(0,r.jsx)("div",{className:"mt-4 px-4 pb-4 print:mt-4 print:p-0 print:max-w-full",children:(0,r.jsx)("p",{className:"text-sm text-muted-foreground text-center italic print:text-xs",children:"Ovaj programčić je u testnoj fazi te pruža samo indikativne rezultate nasljeđivanja i ni na koji način ne garantuje tačnost dobijenih podataka. Takođe, on nije namijenjen za složene situacije: ustupanje ustupljenog dijela i sl."})})]})]})}var eK=t(1949),eX=t(594);function e$(e,a){return(e=Math.abs(Math.round(e)),a=Math.abs(Math.round(a)),isNaN(e)||isNaN(a)||!Number.isFinite(e)||!Number.isFinite(a))?1:0===a?e:e$(a,e%a)}function eQ(e,a){if(e=Math.abs(Math.round(e)),a=Math.abs(Math.round(a)),isNaN(e)||isNaN(a)||!Number.isFinite(e)||!Number.isFinite(a))return 1;if(0===e||0===a)return 0;let t=Math.abs(e*a)/e$(e,a);return Number.isFinite(t)?t:0}function e0(e){if(!e||"number"!=typeof e.numerator||"number"!=typeof e.denominator||isNaN(e.numerator)||isNaN(e.denominator)||!Number.isFinite(e.numerator)||!Number.isFinite(e.denominator))return{numerator:0,denominator:1};if(0===e.denominator)return{numerator:e.numerator>0?1:e.numerator<0?-1:0,denominator:0};if(0===e.numerator)return{numerator:0,denominator:1};let a=Math.round(e.numerator),t=Math.round(e.denominator),r=e$(Math.abs(a),Math.abs(t)),n=a/r,i=t/r;return(i<0&&(n=-n,i=-i),0===i&&0!==t)?{numerator:a,denominator:t}:{numerator:n,denominator:i}}function e1(e,a){if(e||(e={numerator:0,denominator:1}),a||(a={numerator:0,denominator:1}),0===e.denominator||0===a.denominator)return{numerator:(0===e.denominator?e.numerator:0)+(0===a.denominator?a.numerator:0),denominator:0};let t=eQ(e.denominator,a.denominator);return 0===t||isNaN(t)||!Number.isFinite(t)?e0({numerator:e.numerator*a.denominator+a.numerator*e.denominator,denominator:e.denominator*a.denominator}):e0({numerator:e.numerator*(t/e.denominator)+a.numerator*(t/a.denominator),denominator:t})}function e4(e,a){if(e||(e={numerator:0,denominator:1}),a||(a={numerator:0,denominator:1}),0===e.denominator||0===a.denominator)return{numerator:(0===e.denominator?e.numerator:0)-(0===a.denominator?a.numerator:0),denominator:0};let t=eQ(e.denominator,a.denominator);return 0===t||isNaN(t)||!Number.isFinite(t)?e0({numerator:e.numerator*a.denominator-a.numerator*e.denominator,denominator:e.denominator*a.denominator}):e0({numerator:e.numerator*(t/e.denominator)-a.numerator*(t/a.denominator),denominator:t})}function e2(e,a){return(e||(e={numerator:0,denominator:1}),a||(a={numerator:0,denominator:1}),0===e.denominator||0===a.denominator)?{numerator:e.numerator*a.numerator,denominator:0}:e0({numerator:e.numerator*a.numerator,denominator:e.denominator*a.denominator})}function e5(e,a){return(e||(e={numerator:0,denominator:1}),0===a||isNaN(a)||!Number.isFinite(a)||0===e.denominator)?{numerator:e.numerator,denominator:0}:e0({numerator:e.numerator,denominator:e.denominator*a})}function e3(e,a){if(!e||!a||void 0===e.numerator||void 0===e.denominator||void 0===a.numerator||void 0===a.denominator)return 0;if(0===e.denominator||0===a.denominator)return 0===e.denominator&&0!==a.denominator?e.numerator>0?1:e.numerator<0?-1:0:0===a.denominator&&0!==e.denominator?a.numerator>0?-1:+(a.numerator<0):0;let t=e.numerator*a.denominator,r=a.numerator*e.denominator;return t>r?1:t<r?-1:0}function e6(e){let a=[];return e.forEach(e=>{a.push(e),e.descendants&&e.descendants.length>0&&(a=a.concat(e6(e.descendants)))}),a}let e8={numerator:0,denominator:1},e9={numerator:1,denominator:2},e7={numerator:1,denominator:1};function ae(e,a){return!!e&&!e.isAlive&&!!e.descendants&&0!==e.descendants.length&&e.descendants.some(e=>{let t=a.get(e.id);return!!t&&(t.isAlive||ae(t,a))})}function aa(e,a,t,r){let n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;if(e.isAlive){0===n&&(t[e.id]=e1(t[e.id]||e8,a));return}if(!e.descendants||0===e.descendants.length)return;let i=e.descendants.map(e=>r.get(e.id)).filter(Boolean);if(0===i.length)return;let s=e5(a,i.length);i.forEach(e=>{t[e.id]=e1(t[e.id]||e8,s),e.descendants&&e.descendants.length>0&&aa(e,s,t,r,n+1)})}function at(e,a,t){let r=!1;return!function e(n){var i;if(r)return;let s=t.get(n);if(s){if(s.isAlive&&s.acceptsInheritance&&(null===(i=a[s.id])||void 0===i?void 0:i.numerator)>0){r=!0;return}if(s.descendants){for(let a of s.descendants)if(e(a.id),r)return}}}(e.id),r}function ar(e,a,t,r,n){let i=[],s=e8;!function e(a){let t=n.get(a);if(!t)return;let o=r[t.id];t.isAlive&&t.acceptsInheritance&&o&&o.numerator>0?(i.push({heir:t,hypoShare:o}),s=e1(s,o)):t.descendants&&t.descendants.length>0&&t.descendants.forEach(a=>{e(a.id)})}(e.id),0!==i.length&&0!==s.numerator&&i.forEach(e=>{let r;let n=e.hypoShare;r=0===s.denominator||0===s.numerator?e8:e0(e2(n,{numerator:s.denominator,denominator:s.numerator}));let i=e2(a,r);t[e.heir.id]=e1(t[e.heir.id]||e8,i)})}function an(e,a,t,r,n){let i=e8;if(e.isAlive&&e.acceptsInheritance)r[e.id]=e1(r[e.id]||e8,a),t[e.id]=e1(t[e.id]||e8,a);else if(!e.isAlive&&e.descendants){let s={};aa(e,a,s,n),Object.keys(s).forEach(e=>{r[e]=e1(r[e]||e8,s[e])});let o=!1;for(let e in s){let a=n.get(e),r=s[e];a&&a.isAlive&&a.acceptsInheritance&&r&&r.numerator>0?(t[a.id]=e1(t[a.id]||e8,r),o=!0):r&&r.numerator>0&&(i=e1(i,r))}o||!(a.numerator>0)||ae(e,n)||(i=e1(i,a))}else i=e1(i,a),r[e.id]=e1(r[e.id]||e8,a);return i}function ai(e,a,t){let r={};for(let a in new Set(t.keys()).forEach(a=>{r[a]=e0(e[a]||e8)}),e)r.hasOwnProperty(a)||(r[a]=e0(e[a]||e8));return r}let as=(0,d.F)("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),ao=n.forwardRef((e,a)=>{let{className:t,variant:n,...i}=e;return(0,r.jsx)("div",{ref:a,role:"alert",className:(0,c.cn)(as({variant:n}),t),...i})});ao.displayName="Alert";let al=n.forwardRef((e,a)=>{let{className:t,...n}=e;return(0,r.jsx)("h5",{ref:a,className:(0,c.cn)("mb-1 font-medium leading-none tracking-tight",t),...n})});al.displayName="AlertTitle";let ad=n.forwardRef((e,a)=>{let{className:t,...n}=e;return(0,r.jsx)("div",{ref:a,className:(0,c.cn)("text-sm [&_p]:leading-relaxed",t),...n})});ad.displayName="AlertDescription";let ac=o.Yj().regex(/^\s*\d+\s*\/\s*\d+\s*$/,{message:"Format: 'brojilac / imenilac' (npr. '1 / 2')"}).transform((e,a)=>{let t=e.split("/").map(e=>e.trim()),r=parseInt(t[0],10),n=parseInt(t[1],10);return isNaN(r)||isNaN(n)||n<=0||r<0?(a.addIssue({code:o.eq.custom,message:"Neispravan razlomak. Brojilac mora biti >= 0, imenilac > 0."}),o.tm):r>n?(a.addIssue({code:o.eq.custom,message:"Brojilac ne može biti veći od imenioca za ovaj unos."}),o.tm):{numerator:r,denominator:n}}),am=o.Ik({donorId:o.Yj().min(1,{message:"Molimo izaberite donatora."}),recipientId:o.Yj().min(1,{message:"Molimo izaberite primaoca."}),portionOfShare:ac}).refine(e=>e.donorId!==e.recipientId,{message:"Donator i primalac ne mogu biti ista osoba.",path:["recipientId"]}),au={numerator:1,denominator:1},ap={numerator:0,denominator:1},ah=(e,a)=>{let t=e.find(e=>e.id===a);return t?t.name:"Nepoznat"},af=e=>{if(!e||void 0===e.numerator||void 0===e.denominator)return"0/1";let a=e0(e);return 0===a.denominator?"N/A":0===a.numerator?"0":1===a.denominator&&0!==a.numerator?a.numerator.toString():"".concat(a.numerator,"/").concat(a.denominator)};function aj(e){var a;let{eligibleDonors:t,potentialRecipients:o,donationRules:l,setDonationRules:d,initialShares:c}=e,[m,h]=(0,n.useState)(!1),[f,j]=(0,n.useState)(null),x=0===t.length,g=(0,i.mN)({resolver:(0,s.u)(am),defaultValues:{donorId:"",recipientId:"",portionOfShare:"0 / 1"},mode:"onChange"}),{setError:A,clearErrors:w,formState:{errors:R},watch:P,setValue:M,reset:S}=g,D=P("donorId"),q=P("portionOfShare");(0,n.useEffect)(()=>{if(D&&c){let e=c[D]||ap,a=ap;l.forEach(e=>{e.donorId===D&&(a=e1(a,e.portionOfShare))});let t=e4(au,a=e0(a));j({initialAbsoluteShare:e0(e),totalRelativePortionAllocatedByDonor:a,maxRelativePortionForNewRule:e0(t.numerator<0?ap:t),isFullyAllocated:e3(a,au)>=0})}else j(null)},[D,c,l]),(0,n.useEffect)(()=>{var e,a;if((null===(e=R.portionOfShare)||void 0===e?void 0:e.type)==="invalid_string"||(null===(a=R.portionOfShare)||void 0===a?void 0:a.type)==="custom")return;w("portionOfShare");let t=ac.safeParse(q);if(!t.success)return;let r=t.data;if(f){let e=f.maxRelativePortionForNewRule,a=f.isFullyAllocated&&0===e3(f.totalRelativePortionAllocatedByDonor,au);a&&r.numerator>0?A("portionOfShare",{type:"manual_fully_allocated",message:"Donator je već alocirao 100% svog dijela. Unesite '0 / 1' ili izmijenite postojeća pravila."}):e3(r,e)>0&&!a&&A("portionOfShare",{type:"manual_exceeds_remaining_share",message:"Ne možete dodijeliti više od preostalog dijela donatora (".concat(af(e)," njegovog početnog udjela).")})}},[q,f,R.portionOfShare,A,w]);let B=e=>{d(a=>a.filter(a=>a.id!==e))},J=D&&c&&(null===(a=c[D])||void 0===a?void 0:a.numerator)===0,W=!D||J||(null==f?void 0:f.isFullyAllocated)&&0===e3(f.totalRelativePortionAllocatedByDonor,au),Y=[...new Set([...t,...o])];return(0,r.jsxs)(G,{className:"mt-6 border-primary/30 shadow",children:[(0,r.jsxs)(z,{className:"bg-primary/5 rounded-t-md",children:[(0,r.jsxs)(H,{className:"text-lg flex items-center",children:[(0,r.jsx)(eU.A,{className:"mr-2 h-5 w-5 text-primary"})," Preraspodjela Nasljednih Dijelova (Opciono)"]}),(0,r.jsx)(L,{children:"Definišite kako nasljednici ustupaju svoje dijelove drugim nasljednicima. Ustupiti mogu samo živi nasljednici koji prihvataju nasljedstvo, imaju dio veći od nule i sami nisu primaoci donacije. Ako donator odluči da ustupi dio svog nasljedstva, **mora ustupiti cjelokupan svoj nasljedni dio** jednom ili više primalaca. Unesite dio **početnog udjela DONATORA** koji se ustupa svakom primaocu (npr. '1/2' ako donator ustupa polovinu svog dijela tom primaocu). Zbir svih ustupljenih dijelova od strane jednog donatora mora biti tačno 100% (ili 1/1) njegovog početnog udjela da bi ustupanje bilo važeće."})]}),(0,r.jsxs)(U,{className:"pt-4",children:[l.length>0&&(0,r.jsx)(V,{className:"h-36 mb-4 border rounded-md p-2 bg-secondary/20",children:(0,r.jsx)("ul",{className:"space-y-2",children:l.map(e=>(0,r.jsxs)("li",{className:"flex items-center justify-between p-2 rounded-md bg-card border border-border",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-1 text-sm flex-wrap gap-x-1",children:[(0,r.jsx)("span",{className:"font-medium",children:ah(Y,e.donorId)}),(0,r.jsx)(eU.A,{className:"h-3 w-3 text-muted-foreground"}),(0,r.jsx)("span",{className:"font-medium",children:ah(Y,e.recipientId)}),(0,r.jsxs)("span",{className:"text-muted-foreground ml-1 whitespace-nowrap",children:["(",af(e.portionOfShare)," ",(0,r.jsx)("span",{className:"italic text-xs",children:"donatorovog dijela"}),")"]})]}),(0,r.jsx)(u,{variant:"ghost",size:"icon",onClick:()=>B(e.id),"aria-label":"Ukloni pravilo ".concat(e.id),children:(0,r.jsx)(ec.A,{className:"h-4 w-4 text-destructive hover:text-destructive/80"})})]},e.id))})}),!m&&(0,r.jsxs)(u,{onClick:()=>{h(!0),S({donorId:"",recipientId:"",portionOfShare:"0 / 1"}),j(null),w()},variant:"outline",className:"w-full border-primary/50 text-primary hover:bg-primary/10 hover:text-primary",disabled:x&&!!c,children:[(0,r.jsx)(ed.A,{className:"mr-2 h-4 w-4"})," Dodaj Pravilo Preraspodjele"]}),m&&x&&!!c&&(0,r.jsxs)(ao,{variant:"default",className:"my-4 bg-yellow-50 border-yellow-300 text-yellow-800 dark:bg-yellow-900/30 dark:border-yellow-700 dark:text-yellow-300",children:[(0,r.jsx)(eK.A,{className:"h-5 w-5 !text-yellow-600 dark:!text-yellow-400"}),(0,r.jsx)(al,{className:"font-semibold",children:"Nema dostupnih donatora"}),(0,r.jsx)(ad,{children:"Nijedan nasljednik trenutno ne ispunjava uslove da ustupi svoj dio. Donator mora biti živ, prihvatiti nasljedstvo, imati nasljedni dio veći od nule nakon početnog obračuna, ne smije biti primalac donacije od drugog nasljednika, i ne smije već alocirati 100% svog dijela."})]}),m&&(0,r.jsx)(E,{...g,children:(0,r.jsxs)("form",{onSubmit:g.handleSubmit(function(e){let a={id:Date.now().toString(),donorId:e.donorId,recipientId:e.recipientId,portionOfShare:e.portionOfShare};d(e=>[...e,a]),S({donorId:D,recipientId:"",portionOfShare:"0 / 1"})}),className:"space-y-4 p-4 border border-dashed border-primary/50 rounded-md bg-secondary/50 mt-4",children:[!x&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(I,{control:g.control,name:"donorId",render:e=>{let{field:a}=e;return(0,r.jsxs)(F,{children:[(0,r.jsx)(_,{children:"Donator (Ko ustupa dio)"}),(0,r.jsxs)(v,{onValueChange:e=>{a.onChange(e),M("portionOfShare","0 / 1"),M("recipientId",""),w("portionOfShare")},value:a.value||"",children:[(0,r.jsx)(T,{children:(0,r.jsx)(b,{"aria-required":"true",children:(0,r.jsx)(N,{placeholder:"Izaberite donatora"})})}),(0,r.jsx)(y,{children:t.map(e=>(0,r.jsxs)(k,{value:e.id,children:[e.name," ","(".concat(af(c?c[e.id]:ap)," ukupno)")]},e.id))})]}),(0,r.jsx)(C,{})]})}}),f&&D&&!J&&(0,r.jsxs)(G,{className:"p-3 text-sm border ".concat(f.isFullyAllocated&&0!==e3(f.totalRelativePortionAllocatedByDonor,au)?"bg-red-50 dark:bg-red-900/30 border-red-300 dark:border-red-700":"bg-blue-50 dark:bg-blue-900/20 border-blue-200 dark:border-blue-800"),children:[(0,r.jsx)(z,{className:"p-0 mb-2",children:(0,r.jsxs)(H,{className:"text-base flex items-center ".concat(f.isFullyAllocated&&0!==e3(f.totalRelativePortionAllocatedByDonor,au)?"text-red-700 dark:text-red-300":"text-blue-700 dark:text-blue-300"),children:[f.isFullyAllocated&&0!==e3(f.totalRelativePortionAllocatedByDonor,au)?(0,r.jsx)(eK.A,{size:16,className:"mr-2"}):(0,r.jsx)(eX.A,{size:16,className:"mr-2"}),"Status alokacije za: ",ah(t,D)||D]})}),(0,r.jsxs)(U,{className:"p-0 space-y-1 ".concat(f.isFullyAllocated&&0!==e3(f.totalRelativePortionAllocatedByDonor,au)?"text-red-600 dark:text-red-400":"text-blue-600 dark:text-blue-400"),children:[(0,r.jsxs)("p",{children:["Početni udio donatora: ",(0,r.jsx)("span",{className:"font-semibold",children:af(f.initialAbsoluteShare)})," ",(0,r.jsx)("span",{className:"italic text-xs",children:"cjelokupne zaostavštine."})]}),(0,r.jsxs)("p",{children:["Do sada alocirano (drugim pravilima): ",(0,r.jsx)("span",{className:"font-semibold",children:af(f.totalRelativePortionAllocatedByDonor)})," ",(0,r.jsx)("span",{className:"italic text-xs",children:"donatorovog početnog udjela."})]}),f.isFullyAllocated?0===e3(f.totalRelativePortionAllocatedByDonor,au)?(0,r.jsx)("p",{className:"font-semibold text-green-700 dark:text-green-400",children:"Donator je alocirao 100% svog dijela."}):(0,r.jsxs)("p",{className:"font-semibold",children:["Donator NIJE ISPRAVNO alocirao 100% svog dijela (trenutno: ",af(f.totalRelativePortionAllocatedByDonor),"). Njegove donacije neće biti važeće."]}):(0,r.jsxs)("p",{children:["Preostalo za alokaciju: ",(0,r.jsx)("span",{className:"font-semibold",children:af(f.maxRelativePortionForNewRule)})," ",(0,r.jsx)("span",{className:"italic text-xs",children:"donatorovog početnog udjela."})]}),0!==e3(f.totalRelativePortionAllocatedByDonor,au)&&(0,r.jsx)("p",{className:"text-amber-700 dark:text-amber-500 font-medium",children:"UPOZORENJE: Da bi ustupanje bilo važeće, zbir svih ustupljenih dijelova ovog donatora mora biti tačno 100% (1/1) njegovog početnog udjela."})]})]}),(0,r.jsx)(I,{control:g.control,name:"recipientId",render:e=>{let{field:a}=e;return(0,r.jsxs)(F,{children:[(0,r.jsx)(_,{children:"Primalac (Kome se ustupa dio)"}),(0,r.jsxs)(v,{onValueChange:a.onChange,value:a.value||"",disabled:!D||J,children:[(0,r.jsx)(T,{children:(0,r.jsx)(b,{"aria-required":"true",children:(0,r.jsx)(N,{placeholder:"Izaberite primaoca"})})}),(0,r.jsx)(y,{children:o.filter(e=>e.id!==g.watch("donorId")).map(e=>(0,r.jsx)(k,{value:e.id,children:e.name},e.id))})]}),(0,r.jsx)(C,{})]})}}),(0,r.jsx)(I,{control:g.control,name:"portionOfShare",render:e=>{let{field:{onChange:a,value:t,...n}}=e,i="object"==typeof t?"".concat(t.numerator," / ").concat(t.denominator):t;return(0,r.jsxs)(F,{children:[(0,r.jsxs)(_,{className:"flex items-center",children:["Dio Donatorovog Udjela Koji Se Ustupa ",(0,r.jsx)(eL.A,{className:"ml-1 h-3 w-3 opacity-70"})]}),(0,r.jsx)(T,{children:(0,r.jsx)(p,{placeholder:"Npr. 1 / 2 (za polovinu DJELA DONATORA)",value:i,onChange:e=>a(e.target.value),"aria-required":"true",...n,disabled:W})}),(0,r.jsx)(O,{children:"Unesite dio **početnog udjela donatora** koji se ustupa ovom primaocu (npr. '1/2' ako donator ustupa polovinu svog dijela). Ako je donator već alocirao 100% svog dijela, možete unijeti samo '0 / 1'."}),(0,r.jsx)(C,{})]})}})]}),(0,r.jsxs)("div",{className:"flex justify-end space-x-2 pt-2",children:[(0,r.jsx)(u,{type:"button",variant:"ghost",onClick:()=>{h(!1),S({donorId:"",recipientId:"",portionOfShare:"0 / 1"}),j(null),w()},children:"Zatvori Formu"}),!x&&(0,r.jsx)(u,{type:"submit",disabled:!g.formState.isValid||!D||J||(null==f?void 0:f.isFullyAllocated)&&0!==e3(f.totalRelativePortionAllocatedByDonor,au)&&(null==f?void 0:f.totalRelativePortionAllocatedByDonor.numerator)!==0,children:"Sačuvaj Pravilo"})]})]})})]})]})}var ax=t(7481),av=t(9876),aN=t(8018),ab=t(3005),ag=t(7649);let aA=ag.bL,ay=ag.l9,ak=ag.ZL,aw=n.forwardRef((e,a)=>{let{className:t,...n}=e;return(0,r.jsx)(ag.hJ,{className:(0,c.cn)("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",t),...n,ref:a})});aw.displayName=ag.hJ.displayName;let aR=n.forwardRef((e,a)=>{let{className:t,...n}=e;return(0,r.jsxs)(ak,{children:[(0,r.jsx)(aw,{}),(0,r.jsx)(ag.UC,{ref:a,className:(0,c.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",t),...n})]})});aR.displayName=ag.UC.displayName;let aP=e=>{let{className:a,...t}=e;return(0,r.jsx)("div",{className:(0,c.cn)("flex flex-col space-y-2 text-center sm:text-left",a),...t})};aP.displayName="AlertDialogHeader";let aE=e=>{let{className:a,...t}=e;return(0,r.jsx)("div",{className:(0,c.cn)("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",a),...t})};aE.displayName="AlertDialogFooter";let aM=n.forwardRef((e,a)=>{let{className:t,...n}=e;return(0,r.jsx)(ag.hE,{ref:a,className:(0,c.cn)("text-lg font-semibold",t),...n})});aM.displayName=ag.hE.displayName;let aI=n.forwardRef((e,a)=>{let{className:t,...n}=e;return(0,r.jsx)(ag.VY,{ref:a,className:(0,c.cn)("text-sm text-muted-foreground",t),...n})});aI.displayName=ag.VY.displayName;let aS=n.forwardRef((e,a)=>{let{className:t,...n}=e;return(0,r.jsx)(ag.rc,{ref:a,className:(0,c.cn)(m(),t),...n})});aS.displayName=ag.rc.displayName;let aD=n.forwardRef((e,a)=>{let{className:t,...n}=e;return(0,r.jsx)(ag.ZD,{ref:a,className:(0,c.cn)(m({variant:"outline"}),"mt-2 sm:mt-0",t),...n})});aD.displayName=ag.ZD.displayName;let aF={numerator:0,denominator:1},a_={numerator:1,denominator:1};function aT(){let[e,a]=(0,n.useState)(""),[t,i]=(0,n.useState)([]),[s,o]=(0,n.useState)(null),[l,d]=(0,n.useState)([]),[c,m]=(0,n.useState)(null),[h,f]=(0,n.useState)(!1),[j,x]=(0,n.useState)(!1),[v,N]=(0,n.useState)(""),[b,g]=(0,n.useState)(null),{toast:A}=(0,ax.dj)(),y=(0,n.useCallback)(()=>{if(!e.trim()){A({title:"Greška",description:"Molimo unesite ime ostavioca.",variant:"destructive"});return}if(0===t.length){A({title:"Informacija",description:"Nema unesenih nasljednika za obračun.",variant:"default"}),o({}),m({}),g(null),x(!1);return}let a=function(e){var a,t,r,n,i,s;let o={},l=e7,d=e6(e),c=new Map(d.map(e=>[e.id,e]));d.forEach(e=>o[e.id]=e8);let m=e.find(e=>"SPOUSE"===e.relationship),u=m&&m.isAlive&&m.acceptsInheritance?m:void 0;if(u&&u.requestSeparateHalf&&(o[u.id]=e1(o[u.id]||e8,e9),(l=e4(l,e9)).numerator<=0&&l.denominator>0)){if(!d.some(e=>e.id!==u.id&&!!(e.isAlive&&e.acceptsInheritance||!e.isAlive&&ae(e,c))))return o[u.id]=e7,ai(o,e,c);if(0===l.numerator)return ai(o,e,c)}if(l.numerator>0){let i=e.filter(e=>"CHILD"===e.relationship).filter(e=>e.isAlive||!e.isAlive&&ae(e,c)).map(e=>c.get(e.id)).filter(Boolean),s=i.length,m=!1;if(u&&(s>0?(s++,m=!0):(o[u.id]=e1(o[u.id]||e8,l),l=e8)),s>0&&l.numerator>0){let e=l,p=e5(e,s),h={};d.forEach(e=>h[e.id]=e8),i.forEach(e=>{e.isAlive?h[e.id]=e1(h[e.id]||e8,p):aa(e,p,h,c)}),m&&u&&(h[u.id]=e1(h[u.id]||e8,p));let f=e8;if(d.forEach(e=>{let a=c.get(e.id);if(!a)return;let t=h[a.id];t&&t.numerator>0&&(a.isAlive&&a.acceptsInheritance?o[a.id]=e1(o[a.id]||e8,t):f=e1(f,t))}),f.numerator>0){let e=[];i.forEach(a=>{at(a,o,c)&&e.push(a)});let a=!1;m&&u&&(null===(r=o[u.id])||void 0===r?void 0:r.numerator)>0&&(a=!0);let t=e.length+ +!!a;if(t>0){let r=e5(f,t);e.forEach(e=>{ar(e,r,o,h,c)}),a&&u&&(o[u.id]=e1(o[u.id]||e8,r))}}let j=e8;if(i.forEach(e=>{d.forEach(e=>{var a;(null===(a=h[e.id])||void 0===a?void 0:a.numerator)>0&&(j=e1(j,o[e.id]||e8))})}),m&&u&&(null===(a=h[u.id])||void 0===a?void 0:a.numerator)>0)for(let e in j=e8,h)(null===(n=h[e])||void 0===n?void 0:n.numerator)>0&&(j=e1(j,o[e]||e8));else!m&&u&&(null===(t=o[u.id])||void 0===t?void 0:t.numerator)>0&&0===i.length&&(j=o[u.id]);l=e4(e,j)}else l.numerator;Object.values(o).some(e=>e.numerator>0);let p=e8;for(let e in o)p=u&&e===u.id&&u.requestSeparateHalf?e1(p,e4(o[e],e9)):e1(p,o[e]);if(p.numerator>0&&l.numerator<=0&&l.denominator>0)return ai(o,e,c)}if(l.numerator>0){let a=e.filter(e=>"PARENT"===e.relationship),t=a.filter(e=>e.isAlive&&e.acceptsInheritance),r=a.filter(e=>!e.isAlive&&ae(e,c)),n=l,s=e8;if(u&&(t.length>0||r.length>0?(s=e2(n,e9),o[u.id]=e1(o[u.id]||e8,s),n=e4(n,s)):(o[u.id]=e1(o[u.id]||e8,n),n=e8)),n.numerator>0){let e=[...t,...r.map(e=>c.get(e.id)).filter(Boolean)];if(e.length>0){let a=e5(n,e.length),t=e8,r={};if(d.forEach(e=>r[e.id]=e8),e.forEach(e=>{e.isAlive&&e.acceptsInheritance?(r[e.id]=e1(r[e.id]||e8,a),o[e.id]=e1(o[e.id]||e8,a)):!e.isAlive&&e.descendants?(aa(e,a,r,c),e.descendants.forEach(e=>{let a=c.get(e.id);if(!a)return;let n=r[a.id];n&&n.numerator>0&&(a.isAlive&&a.acceptsInheritance?o[a.id]=e1(o[a.id]||e8,n):t=e1(t,n))})):t=e1(t,a)}),t.numerator>0){let a=[];e.forEach(e=>{at(e,o,c)&&a.push(e)});let n=!1;u&&s.numerator>0&&(null===(i=o[u.id])||void 0===i?void 0:i.numerator)>0&&(n=!0);let l=a.length+ +!!n;if(l>0){let e=e5(t,l);a.forEach(a=>{ar(a,e,o,r,c)}),n&&u&&(o[u.id]=e1(o[u.id]||e8,e))}}}}let m=new Set;for(let e of(u&&(t.length>0||r.length>0)?m.add(u.id):u&&m.add(u.id),a.forEach(e=>{m.add(e.id),e.descendants&&e.descendants.forEach(e=>m.add(e.id))}),m));let p=e8;if(Object.values(o).forEach(e=>p=e1(p,e)),u&&u.requestSeparateHalf){let e=o[u.id];e&&e3(e,e9)}if((l=e4(e7,p)).numerator<=0&&l.denominator>0)return ai(o,e,c)}if(l.numerator>0){let a=["PATERNAL_GRANDFATHER","PATERNAL_GRANDMOTHER","MATERNAL_GRANDFATHER","MATERNAL_GRANDMOTHER"],t=e.filter(e=>a.includes(e.relationship)&&(e.isAlive&&e.acceptsInheritance||!e.isAlive&&ae(e,c))).map(e=>c.get(e.id)).filter(Boolean);if(t.length>0){let a=l,r=e8;if(u&&(r=e2(a,e9),o[u.id]=e1(o[u.id]||e8,r),a=e4(a,r)),a.numerator>0&&t.length>0){let e=t.filter(e=>"PATERNAL_GRANDFATHER"===e.relationship||"PATERNAL_GRANDMOTHER"===e.relationship),n=t.filter(e=>"MATERNAL_GRANDFATHER"===e.relationship||"MATERNAL_GRANDMOTHER"===e.relationship),i=e.some(e=>at(e,o,c)||e.isAlive&&e.acceptsInheritance),l=n.some(e=>at(e,o,c)||e.isAlive&&e.acceptsInheritance),m=e8,p=e8;i&&l?(m=e2(a,e9),p=e2(a,e9)):i?m=a:l&&(p=a);let h=e8,f={};if(d.forEach(e=>f[e.id]=e8),m.numerator>0){let a=e5(m,e.length||1);e.forEach(e=>{h=e1(h,an(e,a,o,f,c))})}if(p.numerator>0){let e=e5(p,n.length||1);n.forEach(a=>{h=e1(h,an(a,e,o,f,c))})}if(h.numerator>0){let e=[];t.forEach(a=>{at(a,o,c)&&e.push(a)});let a=!1;u&&r.numerator>0&&(null===(s=o[u.id])||void 0===s?void 0:s.numerator)>0&&(a=!0);let n=e.length+ +!!a;if(n>0){let t=e5(h,n);e.forEach(e=>{ar(e,t,o,f,c)}),a&&u&&(o[u.id]=e1(o[u.id]||e8,t))}}}let n=e8;if(Object.values(o).forEach(e=>n=e1(n,e)),(l=e4(e7,n)).numerator<=0&&l.denominator>0)return ai(o,e,c)}else if(u)return o[u.id]=e1(o[u.id]||e8,l),l=e8,ai(o,e,c)}if(l.numerator>0){let a=["PGF_F","PGF_M","PGM_F","PGM_M","MGF_F","MGF_M","MGM_F","MGM_M"],t=e.filter(e=>a.includes(e.relationship)&&(e.isAlive&&e.acceptsInheritance||!e.isAlive&&ae(e,c))).map(e=>c.get(e.id)).filter(Boolean);if(t.length>0){let e=e5(l,t.length),a={},r=e8;if(t.forEach(t=>{r=e1(r,an(t,e,o,a,c))}),r.numerator>0){let e=[];if(t.forEach(a=>{at(a,o,c)&&e.push(a)}),e.length>0){let t=e5(r,e.length);e.forEach(e=>{ar(e,t,o,a,c)})}}}}return ai(o,e,c)}(t);m(a);let{finalShares:r,warnings:n}=function(e,a,t){var r,n,i;let s={...e},o=[],l=new Map(e6(t).map(e=>[e.id,e])),d={};for(let t of a){let a=l.get(t.donorId);a&&a.isAlive&&a.acceptsInheritance&&e[t.donorId]&&0!==e[t.donorId].numerator&&(d[t.donorId]||(d[t.donorId]={totalRelativePortionAllocated:e8,isValid:!1}),d[t.donorId].totalRelativePortionAllocated=e1(d[t.donorId].totalRelativePortionAllocated,t.portionOfShare))}for(let e in d){let a=d[e];if(a.totalRelativePortionAllocated=e0(a.totalRelativePortionAllocated),0===e3(a.totalRelativePortionAllocated,e7))a.isValid=!0;else{a.isValid=!1;let t=(null===(r=l.get(e))||void 0===r?void 0:r.name)||"Donator ID: ".concat(e);o.push({type:"donor_incomplete_allocation",donorName:t,message:"".concat(t," nije preraspodijelio/la tačno 100% svog dijela (alocirano: ").concat(function(e){if(!e)return"N/A";let a=e0(e);return 0===a.denominator?"Greška (imenilac 0)":"".concat(a.numerator,"/").concat(a.denominator)}(a.totalRelativePortionAllocated),"). Njegove/njene donacije neće biti primijenjene.")})}}let c={};for(let t of a){let a=t.donorId,r=t.recipientId,i=l.get(a),o=l.get(r);if(i&&o&&o.isAlive&&o.acceptsInheritance&&(null===(n=d[a])||void 0===n?void 0:n.isValid)&&e[a]&&e[a].numerator>0){let n=e2(e[a],t.portionOfShare);s[r]=e1(s[r]||e8,n),c[a]=e1(c[a]||e8,n)}}for(let e in c)(null===(i=d[e])||void 0===i?void 0:i.isValid)&&(s[e]=e8);for(let e in s)s[e]=e0(s[e]);return{finalShares:s,warnings:o}}(a,l,t);n.forEach(e=>{A({title:"Upozorenje o Preraspodjeli",description:e.message,variant:"donor_incomplete_allocation"===e.type?"destructive":"default",duration:7e3})}),o(function(e){let a={},t={},r=Object.keys(e);r.forEach(a=>{t[a]=e0(e[a]||e8)});let n=Object.values(t).map(e=>null==e?void 0:e.denominator).filter(e=>"number"==typeof e&&e>0&&Number.isFinite(e));if(0===n.length)return r.forEach(e=>{a[e]=t[e]||{numerator:0,denominator:1}}),a;let i=function(e){if(!e||0===e.length)return 1;let a=e.filter(e=>"number"==typeof e&&!isNaN(e)&&e>0&&Number.isFinite(e));if(0===a.length)return 1;let t=a.reduce((e,a)=>eQ(e,a),1);return 0===t&&a.some(e=>e>0)?a.length>0?Math.max(...a):1:t}(n);return i<=0||isNaN(i)||!Number.isFinite(i)?r.forEach(e=>{a[e]=t[e]||{numerator:0,denominator:1}}):r.forEach(e=>{let r=t[e];if(!r||"number"!=typeof r.numerator||"number"!=typeof r.denominator||isNaN(r.numerator)||isNaN(r.denominator)||!Number.isFinite(r.numerator)||!Number.isFinite(r.denominator)||r.denominator<=0||0===r.numerator){a[e]={numerator:0,denominator:i};return}let n=i/r.denominator;!Number.isFinite(n)||isNaN(n)?a[e]=r:a[e]={numerator:Math.round(r.numerator*n),denominator:i}}),a}(r)),g(null),x(!1)},[t,l,e,A]);return(0,n.useEffect)(()=>{(s||c&&Object.keys(c).length>0)&&y()},[t,l,e]),(0,n.useEffect)(()=>{s||(g(null),x(!1),N(""))},[s]),(0,r.jsxs)("div",{className:"min-h-screen bg-background text-foreground flex flex-col items-center p-4 md:p-8",children:[(0,r.jsxs)("header",{className:"w-full max-w-4xl mb-6 md:mb-10 text-center print-hidden",children:[(0,r.jsx)("div",{className:"flex items-center justify-center mb-2",children:(0,r.jsx)(av.A,{size:50,className:"text-primary"})}),(0,r.jsx)("h1",{className:"text-3xl md:text-4xl font-bold text-primary",children:"Kalkulator nasljedstva"})]}),(0,r.jsxs)("main",{className:"w-full max-w-4xl space-y-6",children:[(0,r.jsx)("div",{className:"print-hidden",children:(0,r.jsx)(eF,{onAddHeir:e=>{i(a=>[...a,e]),o(null),m(null),d([]),g(null),x(!1)},heirs:t,onRemoveHeir:e=>{i(eR(t,e)),o(null),m(null),g(null),x(!1),d(a=>a.filter(a=>a.donorId!==e&&a.recipientId!==e))},deceasedName:e,setDeceasedName:a,setHeirs:i})}),t.length>0&&c&&Object.keys(c).length>0&&(0,r.jsx)("div",{className:"print-hidden",children:(0,r.jsx)(aj,{eligibleDonors:(()=>{if(!c)return[];let e=new Set(l.map(e=>e.recipientId)),a=ew(t),r={};for(let e of l){var n;(null===(n=c[e.donorId])||void 0===n?void 0:n.numerator)>0&&(r[e.donorId]=e1(r[e.donorId]||aF,e.portionOfShare))}return a.filter(a=>{var t;let n=e.has(a.id),i=(null===(t=c[a.id])||void 0===t?void 0:t.numerator)>0,s=!1;return r[a.id]&&0===e3(e0(r[a.id]),a_)&&(s=!0),a.isAlive&&a.acceptsInheritance&&i&&!n&&!s})})(),potentialRecipients:ew(t).filter(e=>e.isAlive&&e.acceptsInheritance),donationRules:l,setDonationRules:d,initialShares:c},"redistribution-form-".concat(l.map(e=>e.id).join("-")))}),(0,r.jsxs)("div",{className:"print-hidden flex flex-col sm:flex-row justify-between items-center gap-4 mt-6",children:[(0,r.jsx)(u,{onClick:y,size:"lg",className:"w-full sm:w-auto bg-accent hover:bg-accent-hover text-accent-foreground px-8 py-3 text-lg shadow-md",disabled:!e.trim(),children:"Izračunaj Nasljedstvo"}),(0,r.jsxs)(aA,{open:h,onOpenChange:f,children:[(0,r.jsx)(ay,{asChild:!0,children:(0,r.jsx)(u,{variant:"destructive",size:"lg",className:"w-full sm:w-auto px-8 py-3 text-lg shadow-md",children:"Resetuj Sve Podatke"})}),(0,r.jsxs)(aR,{children:[(0,r.jsxs)(aP,{children:[(0,r.jsx)(aM,{children:"Potvrda resetovanja"}),(0,r.jsx)(aI,{children:"Da li ste sigurni da želite da obrišete sve unesene podatke o ostaviocu, nasljednicima i pravilima preraspodjele? Ova akcija se ne može opozvati."})]}),(0,r.jsxs)(aE,{children:[(0,r.jsx)(aD,{onClick:()=>f(!1),children:"Odustani"}),(0,r.jsx)(aS,{onClick:()=>{a(""),i([]),o(null),d([]),m(null),f(!1),g(null),x(!1),N(""),A({title:"Resetovano",description:"Svi podaci su obrisani."})},children:"Obriši Sve"})]})]})]})]}),s&&(0,r.jsx)(eZ,{results:s,heirs:t,deceasedName:e,donationRules:l,heirTaxes:b}),s&&Object.keys(s).length>0&&(0,r.jsx)("div",{className:"print-hidden mt-6 flex justify-center",children:(0,r.jsxs)(u,{variant:"outline",onClick:()=>window.print(),className:"text-primary border-primary/50 hover:bg-[hsl(var(--primary-hover))] hover:text-primary-foreground",children:[(0,r.jsx)(aN.A,{className:"mr-2 h-4 w-4"})," Odštampaj Rezultate"]})}),s&&Object.keys(s).length>0&&!b&&!j&&(0,r.jsx)("div",{className:"print-hidden mt-6 flex justify-center",children:(0,r.jsxs)(u,{variant:"outline",onClick:()=>x(!0),className:"text-primary border-primary/50 hover:bg-[hsl(var(--primary-hover))] hover:text-primary-foreground",children:[(0,r.jsx)(ab.A,{className:"mr-2 h-4 w-4"})," Želite li da izračunate i sudske takse za nasljednike?"]})}),j&&(0,r.jsx)("div",{className:"print-hidden",children:(0,r.jsxs)(G,{className:"mt-6 border-primary/30 shadow",children:[(0,r.jsxs)(z,{className:"bg-primary/5 rounded-t-md",children:[(0,r.jsxs)(H,{className:"text-lg flex items-center",children:[(0,r.jsx)(ab.A,{className:"mr-2 h-5 w-5 text-primary"}),"Obračun Sudske Takse"]}),(0,r.jsx)(L,{children:"Unesite ukupan iznos sudske takse koja će biti raspoređena na nasljednike srazmjerno njihovim dijelovima."})]}),(0,r.jsxs)(U,{className:"pt-4 space-y-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)(P,{htmlFor:"totalTaxAmount",className:"mb-2 block",children:"Ukupan iznos sudske takse"}),(0,r.jsx)(p,{id:"totalTaxAmount",type:"number",value:v,onChange:e=>N(e.target.value),placeholder:"Unesite ukupan iznos takse",className:"w-full"})]}),(0,r.jsxs)("div",{className:"flex justify-end space-x-2",children:[(0,r.jsx)(u,{variant:"ghost",onClick:()=>{x(!1),N("")},children:"Odustani"}),(0,r.jsx)(u,{onClick:()=>{let e=parseFloat(v);if(isNaN(e)||e<0){A({title:"Greška",description:"Molimo unesite validan ukupan iznos takse.",variant:"destructive"});return}if(!s){A({title:"Greška",description:"Prvo izračunajte nasljedne dijelove.",variant:"destructive"});return}let a={},r=1;if(Object.values(s).forEach(e=>{e&&e.denominator>0&&(r=e.denominator)}),0===r){ew(t).forEach(e=>{a[e.id]=0}),g(a),x(!1),A({title:"Obračun Taksi",description:"Takse su obračunate (0 jer nema nasljednog dijela ili je imenilac 0)."});return}for(let t in s){let r=s[t];if(r&&r.numerator>0&&r.denominator>0){let n=r.numerator/r.denominator;a[t]=n*e}else a[t]=0}g(a),x(!1),A({title:"Obračun Taksi",description:"Sudske takse su uspješno obračunate."})},className:"bg-accent hover:bg-accent-hover text-accent-foreground",children:"Obračunaj takse"})]})]})]})})]}),(0,r.jsxs)("footer",{className:"w-full max-w-4xl mt-10 pt-6 border-t border-border text-center text-sm text-muted-foreground print-hidden",children:[(0,r.jsx)("p",{children:"Napravljeno sa ljubavlju za kolege Osnovnog suda u Foči. E-mail za sugestije: dragan.osfoca@gmail.com."}),(0,r.jsx)("p",{className:"mt-2",children:(0,r.jsxs)(u,{variant:"link",onClick:()=>{window.open("".concat("/naslednici","/uputstvo.html"),"_blank")},className:"text-primary p-0 h-auto",children:[(0,r.jsx)(en.A,{className:"mr-1 h-4 w-4"})," Uputstvo za korišćenje programa"]})})]})]})}},7481:(e,a,t)=>{"use strict";t.d(a,{dj:()=>u});var r=t(2115);let n=0,i=new Map,s=e=>{if(i.has(e))return;let a=setTimeout(()=>{i.delete(e),c({type:"REMOVE_TOAST",toastId:e})},1e6);i.set(e,a)},o=(e,a)=>{switch(a.type){case"ADD_TOAST":return{...e,toasts:[a.toast,...e.toasts].slice(0,1)};case"UPDATE_TOAST":return{...e,toasts:e.toasts.map(e=>e.id===a.toast.id?{...e,...a.toast}:e)};case"DISMISS_TOAST":{let{toastId:t}=a;return t?s(t):e.toasts.forEach(e=>{s(e.id)}),{...e,toasts:e.toasts.map(e=>e.id===t||void 0===t?{...e,open:!1}:e)}}case"REMOVE_TOAST":if(void 0===a.toastId)return{...e,toasts:[]};return{...e,toasts:e.toasts.filter(e=>e.id!==a.toastId)}}},l=[],d={toasts:[]};function c(e){d=o(d,e),l.forEach(e=>{e(d)})}function m(e){let{...a}=e,t=(n=(n+1)%Number.MAX_SAFE_INTEGER).toString(),r=()=>c({type:"DISMISS_TOAST",toastId:t});return c({type:"ADD_TOAST",toast:{...a,id:t,open:!0,onOpenChange:e=>{e||r()}}}),{id:t,dismiss:r,update:e=>c({type:"UPDATE_TOAST",toast:{...e,id:t}})}}function u(){let[e,a]=r.useState(d);return r.useEffect(()=>(l.push(a),()=>{let e=l.indexOf(a);e>-1&&l.splice(e,1)}),[e]),{...e,toast:m,dismiss:e=>c({type:"DISMISS_TOAST",toastId:e})}}},9434:(e,a,t)=>{"use strict";t.d(a,{cn:()=>i});var r=t(2596),n=t(9688);function i(){for(var e=arguments.length,a=Array(e),t=0;t<e;t++)a[t]=arguments[t];return(0,n.QP)((0,r.$)(a))}}},e=>{var a=a=>e(e.s=a);e.O(0,[426,641,441,684,358],()=>a(4948)),_N_E=e.O()}]);